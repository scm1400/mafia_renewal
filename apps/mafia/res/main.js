/******/ (() => { // webpackBootstrap
/******/ 	"use strict";
/******/ 	var __webpack_modules__ = ({

/***/ 169:
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {



var __spreadArray = this && this.__spreadArray || function (to, from, pack) {
  if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {
    if (ar || !(i in from)) {
      if (!ar) ar = Array.prototype.slice.call(from, 0, i);
      ar[i] = from[i];
    }
  }
  return to.concat(ar || Array.prototype.slice.call(from));
};
Object.defineProperty(exports, "__esModule", ({
  value: true
}));
exports.log = void 0;
exports.isDevServer = isDevServer;
exports.parseJsonString = parseJsonString;
exports.isEmpty = isEmpty;
exports.sendConsoleMessage = sendConsoleMessage;
exports.getPlayerId = getPlayerId;
exports.getPlayerById = getPlayerById;
exports.actionToAllPlayers = actionToAllPlayers;
exports.getCurrentTimeString = getCurrentTimeString;
exports.msToTime = msToTime;
exports.shuffleAndSplit = shuffleAndSplit;
exports.hexTo0xColor = hexTo0xColor;
exports.getLocationAreaCoordinates = getLocationAreaCoordinates;
var Localizer_1 = __webpack_require__(773);
function isDevServer() {
  //@ts-ignore
  return App.getServerEnv() !== "live";
}
function parseJsonString(str) {
  if (!str) return false;
  try {
    // JSONÏúºÎ°ú ÌååÏã±ÏùÑ ÏãúÎèÑÌïòÍ≥† Í≤∞Í≥ºÎ•º Î∞òÌôòÌï©ÎãàÎã§.
    return JSON.parse(str);
  } catch (e) {
    // ÌååÏã± Ï§ë Ïò§Î•òÍ∞Ä Î∞úÏÉùÌïòÎ©¥ falseÎ•º Î∞òÌôòÌï©ÎãàÎã§.
    return false;
  }
}
function isEmpty(obj) {
  for (var key in obj) {
    if (Object.prototype.hasOwnProperty.call(obj, key)) {
      return false;
    }
  }
  return true;
}
function sendConsoleMessage(player, message) {
  var playerId = getPlayerId(player);
  setTimeout(function () {
    if (!getPlayerById(playerId)) return;
  }, 500);
}
function getPlayerId(player) {
  var _a;
  return player.isGuest ? (_a = player.tag.guestId) !== null && _a !== void 0 ? _a : player.id : player.id;
  // return player.id;
}
function getPlayerById(playerId) {
  return App.players.find(function (player) {
    return getPlayerId(player) === playerId;
  });
  // return ScriptApp.getPlayerByID(playerId);
}
function actionToAllPlayers(action) {
  var args = [];
  for (var _i = 1; _i < arguments.length; _i++) {
    args[_i - 1] = arguments[_i];
  }
  for (var _a = 0, _b = App.players; _a < _b.length; _a++) {
    var player = _b[_a];
    if (!player) continue;
    try {
      action.apply(void 0, __spreadArray([player], args, false));
    } catch (error) {}
  }
}
function getCurrentTimeString() {
  var date = new Date();
  var utc = date.getTime() + date.getTimezoneOffset() * 60 * 1000;
  var kstGap = 9 * 60 * 60 * 1000;
  var today = new Date(utc + kstGap);
  return today.toISOString();
}
function msToTime(player, duration) {
  var milliseconds = parseInt((duration % 1000 / 100).toString(), 10),
    seconds = Math.floor(duration / 1000 % 60),
    minutes = Math.floor(duration / (1000 * 60) % 60);
  var minutesStr = minutes < 10 ? "0" + minutes : minutes.toString();
  var secondsStr = seconds < 10 ? "0" + seconds : seconds.toString();
  return Localizer_1.Localizer.getLocalizeString(player, "game_quiz_builder_dashboard_info_solve_time").replace("((MM))", minutesStr).replace("((SS))", secondsStr);
}
function shuffleAndSplit(arr) {
  var _a;
  // Fisher-Yates ÏïåÍ≥†Î¶¨Ï¶òÏúºÎ°ú Î∞∞Ïó¥ ÏÑûÍ∏∞
  var shuffledArr = __spreadArray([], arr, true);
  for (var i = shuffledArr.length - 1; i > 0; i--) {
    var j = Math.floor(Math.random() * (i + 1));
    _a = [shuffledArr[j], shuffledArr[i]], shuffledArr[i] = _a[0], shuffledArr[j] = _a[1];
  }
  var midIndex = Math.floor(shuffledArr.length / 2);
  // Î∞∞Ïó¥ÏùÑ Î∞òÏúºÎ°ú ÎÇòÎàÑÍ∏∞
  var firstHalf = shuffledArr.slice(0, midIndex);
  var secondHalf = shuffledArr.slice(midIndex);
  return [firstHalf, secondHalf];
}
function hexTo0xColor(hex) {
  return parseInt(hex.replace("#", ""), 16);
}
function getLocationAreaCoordinates(locationName) {
  if (!Map.hasLocation(locationName)) return null;
  var locationInfo = Map.getLocationList(locationName)[0];
  var coordinates = [];
  if (locationInfo) {
    for (var x = locationInfo.x; x < locationInfo.x + locationInfo.width; x++) {
      for (var y = locationInfo.y; y < locationInfo.y + locationInfo.height; y++) {
        coordinates.push([x, y]);
      }
    }
  }
  return coordinates;
}

/***/ }),

/***/ 206:
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {



var __spreadArray = this && this.__spreadArray || function (to, from, pack) {
  if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {
    if (ar || !(i in from)) {
      if (!ar) ar = Array.prototype.slice.call(from, 0, i);
      ar[i] = from[i];
    }
  }
  return to.concat(ar || Array.prototype.slice.call(from));
};
var _a;
Object.defineProperty(exports, "__esModule", ({
  value: true
}));
exports.GameFlowManager = exports.phaseDurations = exports.MafiaPhase = exports.GameState = void 0;
var Common_1 = __webpack_require__(169);
var JobTypes_1 = __webpack_require__(669);
// GameState Enum: Í≤åÏûÑÏùò Ï£ºÏöî ÏÉÅÌÉúÎ•º Ï†ïÏùò
var GameState;
(function (GameState) {
  GameState["WAITING"] = "WAITING";
  GameState["IN_PROGRESS"] = "IN_PROGRESS";
  GameState["ENDED"] = "ENDED";
})(GameState || (exports.GameState = GameState = {}));
// ÎßàÌîºÏïÑ Í≤åÏûÑÏùò Îã®Í≥Ñ(phase)Î•º Ï†ïÏùòÌï©ÎãàÎã§.
var MafiaPhase;
(function (MafiaPhase) {
  // 4Î™ÖÎ≥¥Îã§ ÎßéÏùÄ Í≤ΩÏö∞Ïóê ÏÇ¨Ïö©ÎêòÎäî Îã®Í≥Ñ ÏàúÏÑú: Î∞§ ‚Üí ÎÇÆ ‚Üí Ìà¨Ìëú ‚Üí ÏµúÌõÑ Î≥ÄÎ°† ‚Üí Ï∞¨Î∞ò Ìà¨Ìëú ‚Üí Î∞§ ‚Ä¶
  MafiaPhase["NIGHT"] = "NIGHT";
  MafiaPhase["DAY"] = "DAY";
  MafiaPhase["VOTING"] = "VOTING";
  MafiaPhase["FINAL_DEFENSE"] = "FINAL_DEFENSE";
  MafiaPhase["APPROVAL_VOTING"] = "APPROVAL_VOTING";
})(MafiaPhase || (exports.MafiaPhase = MafiaPhase = {}));
exports.phaseDurations = (_a = {}, _a[MafiaPhase.NIGHT] = 30, _a[MafiaPhase.DAY] = 20, _a[MafiaPhase.VOTING] = 30, _a[MafiaPhase.FINAL_DEFENSE] = 20, _a[MafiaPhase.APPROVAL_VOTING] = 30, _a);
var GameFlowManager = /** @class */function () {
  function GameFlowManager(roomNumber) {
    this.state = GameState.WAITING;
    this.dayCount = 0;
    this.gameMode = "classic"; // Í∏∞Î≥∏ Í≤åÏûÑ Î™®Îìú
    this.room = null;
    // Î∞§Ïóê ÏàòÌñâÎêòÎäî Ïï°ÏÖòÎì§ÏùÑ Ï†ÄÏû•ÌïòÎäî Î≥ÄÏàòÎì§
    this.nightActions = [];
    // Ìà¨Ìëú Í≤∞Í≥ºÎ•º Ï†ÄÏû•ÌïòÎäî Î≥ÄÏàò
    this.voteResults = {};
    this.playerVotes = {}; // Í∞Å ÌîåÎ†àÏù¥Ïñ¥Í∞Ä ÎàÑÍµ¨ÏóêÍ≤å Ìà¨ÌëúÌñàÎäîÏßÄ
    this.roomNumber = roomNumber;
  }
  /**
   * Í≤åÏûÑ Î£∏ ÏÑ§Ï†ï
   */
  GameFlowManager.prototype.setGameRoom = function (room) {
    this.room = room;
  };
  /**
   * Í≤åÏûÑ Î™®Îìú ÏÑ§Ï†ï
   * @param mode Í≤åÏûÑ Î™®Îìú ID
   */
  GameFlowManager.prototype.setGameMode = function (mode) {
    this.gameMode = mode;
  };
  /**
   * Í≤åÏûÑ ÏãúÏûë
   * - ÏµúÏÜå 4Î™ÖÏùò ÌîåÎ†àÏù¥Ïñ¥Í∞Ä ÏûàÏñ¥Ïïº Ìï©ÎãàÎã§.
   * - ÌîåÎ†àÏù¥Ïñ¥ Ïó≠Ìï†ÏùÑ Î¨¥ÏûëÏúÑÎ°ú Î∞∞Ï†ïÌï©ÎãàÎã§.
   * - ÌîåÎ†àÏù¥Ïñ¥ ÏàòÏóê Îî∞Îùº Ï¥àÍ∏∞ Îã®Í≥ÑÍ∞Ä Í≤∞Ï†ïÎê©ÎãàÎã§.
   *   ‚Üí 4Î™Ö: ÎÇÆÎ∂ÄÌÑ∞ ÏãúÏûë
   *   ‚Üí 4Î™ÖÎ≥¥Îã§ ÎßéÏùÄ Í≤ΩÏö∞: Î∞§Î∂ÄÌÑ∞ ÏãúÏûë
   */
  GameFlowManager.prototype.startGame = function () {
    var _this = this;
    if (!this.room) {
      console.error("Í≤åÏûÑ Î£∏Ïù¥ ÏÑ§Ï†ïÎêòÏßÄ ÏïäÏïòÏäµÎãàÎã§.");
      return;
    }
    if (this.room.players.length < 4) {
      App.showCenterLabel("Í≤åÏûÑ ÏãúÏûëÏùÑ ÏúÑÌï¥ ÏµúÏÜå 4Î™ÖÏùò ÌîåÎ†àÏù¥Ïñ¥Í∞Ä ÌïÑÏöîÌï©ÎãàÎã§");
      return;
    }
    // ÌîåÎ†àÏù¥Ïñ¥ Ïó≠Ìï† Î¨¥ÏûëÏúÑ Î∞∞Ï†ï
    var playersShuffled = __spreadArray([], this.room.players, true);
    playersShuffled.sort(function () {
      return Math.random() - 0.5;
    });
    // Í∏∞Î≥∏ Ïù¥Î™®ÏßÄ Ìï†Îãπ
    var emojis = ["üòÄ", "üòé", "ü§†", "üßê", "ü§ì", "üòä", "üôÇ", "ÔøΩÔøΩ", "üòÅ", "ü§©"];
    // Í≤åÏûÑ Î™®ÎìúÏóê Îî∞Î•∏ ÏßÅÏóÖ Î∞∞Ï†ï
    var availableJobs = this.getAvailableJobs();
    var jobsNeeded = Math.min(playersShuffled.length, availableJobs.length);
    // ÏßÅÏóÖ Î∞∞Ï†ï Î∞è Ïù¥Î™®ÏßÄ Ìï†Îãπ
    for (var i = 0; i < playersShuffled.length; i++) {
      // Ïù¥Î™®ÏßÄ Ìï†Îãπ
      playersShuffled[i].emoji = emojis[i % emojis.length];
      // ÏßÅÏóÖ Î∞∞Ï†ï
      if (i < jobsNeeded) {
        playersShuffled[i].jobId = availableJobs[i].id;
        // Îä•Î†• ÏÇ¨Ïö© ÌöüÏàò Ï¥àÍ∏∞Ìôî
        if (availableJobs[i].usesPerGame) {
          playersShuffled[i].abilityUses = availableJobs[i].usesPerGame;
        }
      } else {
        // ÎÇ®ÏùÄ ÌîåÎ†àÏù¥Ïñ¥Îäî ÏãúÎØºÏúºÎ°ú ÏÑ§Ï†ï
        playersShuffled[i].jobId = JobTypes_1.JobId.CITIZEN;
      }
      playersShuffled[i].isAlive = true;
    }
    // Í≤åÏûÑ ÏÉÅÌÉú Ï¥àÍ∏∞Ìôî
    this.state = GameState.IN_PROGRESS;
    this.dayCount = 1;
    // ÌîåÎ†àÏù¥Ïñ¥ ÏàòÏóê Îî∞Îùº Ï¥àÍ∏∞ Îã®Í≥Ñ Í≤∞Ï†ï
    if (this.room.players.length <= 4) {
      this.phaseCycle = [MafiaPhase.DAY, MafiaPhase.VOTING, MafiaPhase.FINAL_DEFENSE, MafiaPhase.APPROVAL_VOTING];
      this.setPhase(MafiaPhase.DAY);
    } else {
      this.phaseCycle = [MafiaPhase.NIGHT, MafiaPhase.DAY, MafiaPhase.VOTING, MafiaPhase.FINAL_DEFENSE, MafiaPhase.APPROVAL_VOTING];
      this.setPhase(MafiaPhase.NIGHT);
    }
    // Í≤åÏûÑ ÏãúÏûë Î©îÏãúÏßÄ ÌëúÏãú
    App.showCenterLabel("Í≤åÏûÑÏù¥ ÏãúÏûëÎêòÏóàÏäµÎãàÎã§!");
    // Í∞Å ÌîåÎ†àÏù¥Ïñ¥ÏóêÍ≤å Ïó≠Ìï† Ïπ¥Îìú ÌëúÏãú
    this.room.players.forEach(function (player) {
      var gamePlayer = _this.room.getGamePlayer(player.id);
      if (gamePlayer) {
        _this.showRoleCard(gamePlayer, player.jobId);
        _this.initGameStatusWidgets();
      }
    });
    // Ï≤´ Îã®Í≥Ñ Ïã§Ìñâ
    this.executePhaseActions();
  };
  // Í≤åÏûÑ Î™®ÎìúÏóê Îî∞Îùº ÏÇ¨Ïö© Í∞ÄÎä•Ìïú ÏßÅÏóÖ Î™©Î°ù Í∞ÄÏ†∏Ïò§Í∏∞
  GameFlowManager.prototype.getAvailableJobs = function () {
    // JobTypes.tsÏóêÏÑú getJobsByGameMode Ìï®Ïàò ÏÇ¨Ïö©
    var jobs = (0, JobTypes_1.getJobsByGameMode)(this.gameMode);
    // ÏßÅÏóÖ ÏÑûÍ∏∞
    return __spreadArray([], jobs, true).sort(function () {
      return Math.random() - 0.5;
    });
  };
  // Ïó≠Ìï† Ïπ¥Îìú ÌëúÏãú
  GameFlowManager.prototype.showRoleCard = function (player, jobId) {
    var job = (0, JobTypes_1.getJobById)(jobId);
    if (!job) return;
    // Ïó≠Ìï† Ïπ¥Îìú ÏúÑÏ†Ø ÌëúÏãú
    player.tag.widget.roleCard = player.showWidget("widgets/role_card.html", "popup", 300, 400);
    // Ï¥àÍ∏∞Ìôî Î©îÏãúÏßÄ Ï†ÑÏÜ°
    player.tag.widget.roleCard.sendMessage({
      type: "init",
      isMobile: player.isMobile,
      isTablet: player.isTablet
    });
    // Ïó≠Ìï† Ï†ïÎ≥¥ Ï†ÑÏÜ°
    player.tag.widget.roleCard.sendMessage({
      type: "role_info",
      role: job.name,
      team: job.team,
      description: job.description,
      ability: job.abilityDescription,
      icon: job.icon || "‚ùì"
    });
  };
  /**
   * Í≤åÏûÑ ÏÉÅÌÉú ÏúÑÏ†ØÏùÑ Î™®Îì† ÌîåÎ†àÏù¥Ïñ¥ÏóêÍ≤å Ï¥àÍ∏∞ÌôîÌï©ÎãàÎã§.
   */
  GameFlowManager.prototype.initGameStatusWidgets = function () {
    var _this = this;
    if (!this.room) return;
    this.room.actionToRoomPlayers(function (player) {
      var gamePlayer = (0, Common_1.getPlayerById)(player.id);
      if (!gamePlayer) return;
      // Í≤åÏûÑ ÏÉÅÌÉú ÏúÑÏ†Ø ÏÉùÏÑ±
      if (!gamePlayer.tag.widget) {
        gamePlayer.tag.widget = {};
      }
      // Í≤åÏûÑ ÏÉÅÌÉú ÏúÑÏ†Ø ÏÉùÏÑ±
      gamePlayer.tag.widget.gameStatus = gamePlayer.showWidget("widgets/game_status.html", "middleright", 10, 10);
      // Ï¥àÍ∏∞Ìôî Î©îÏãúÏßÄ Ï†ÑÏÜ°
      gamePlayer.tag.widget.gameStatus.sendMessage({
        type: "init",
        isMobile: gamePlayer.isMobile,
        isTablet: gamePlayer.isTablet
      });
      // Í≤åÏûÑ ÏÉÅÌÉú Ï†ïÎ≥¥ Ï†ÑÏÜ°
      _this.updateGameStatusWidget(gamePlayer, player);
    });
  };
  /**
   * ÌäπÏ†ï ÌîåÎ†àÏù¥Ïñ¥Ïùò Í≤åÏûÑ ÏÉÅÌÉú ÏúÑÏ†ØÏùÑ ÏóÖÎç∞Ïù¥Ìä∏Ìï©ÎãàÎã§.
   */
  GameFlowManager.prototype.updateGameStatusWidget = function (gamePlayer, player) {
    var _a;
    if (!gamePlayer || !gamePlayer.tag.widget.gameStatus) return;
    gamePlayer.tag.widget.gameStatus.sendMessage({
      type: 'updateGameStatus',
      phase: this.currentPhase,
      day: this.dayCount,
      players: ((_a = this.room) === null || _a === void 0 ? void 0 : _a.players) || [],
      myRole: player.jobId,
      myPlayerId: player.id,
      timeRemaining: this.phaseTimer
    });
  };
  /**
   * Î™®Îì† ÌîåÎ†àÏù¥Ïñ¥Ïùò Í≤åÏûÑ ÏÉÅÌÉú ÏúÑÏ†ØÏùÑ ÏóÖÎç∞Ïù¥Ìä∏Ìï©ÎãàÎã§.
   */
  GameFlowManager.prototype.updateAllGameStatusWidgets = function () {
    var _this = this;
    if (!this.room) return;
    this.room.actionToRoomPlayers(function (player) {
      var gamePlayer = (0, Common_1.getPlayerById)(player.id);
      if (!gamePlayer) return;
      _this.updateGameStatusWidget(gamePlayer, player);
    });
  };
  /**
   * ÌòÑÏû¨ Îã®Í≥ÑÏóêÏÑú Îã§Ïùå Îã®Í≥ÑÎ°ú Ï†ÑÌôòÌï©ÎãàÎã§.
   * Îã®Í≥Ñ ÏàúÏÑúÎäî phaseCycle Î∞∞Ïó¥Ïóê Îî∞Îùº ÏßÑÌñâÎêòÎ©∞,
   * ÏÇ¨Ïù¥ÌÅ¥Ïù¥ Ï≤òÏùåÏúºÎ°ú ÎèåÏïÑÏò§Î©¥ dayCountÎ•º Ï¶ùÍ∞ÄÏãúÌÇµÎãàÎã§.
   */
  GameFlowManager.prototype.nextPhase = function () {
    if (this.state !== GameState.IN_PROGRESS) {
      App.sayToAll("Í≤åÏûÑÏù¥ ÏßÑÌñâ Ï§ëÏù¥ ÏïÑÎãôÎãàÎã§.");
      return;
    }
    var currentIndex = this.phaseCycle.indexOf(this.currentPhase);
    var nextIndex = (currentIndex + 1) % this.phaseCycle.length;
    // ÏÇ¨Ïù¥ÌÅ¥Ïù¥ Ï≤òÏùåÏúºÎ°ú ÎèåÏïÑÏò§Î©¥ dayCount Ï¶ùÍ∞Ä
    if (nextIndex === 0) {
      this.dayCount++;
    }
    this.setPhase(this.phaseCycle[nextIndex]);
    App.sayToAll("Room ".concat(this.room.id, ": \uB2E8\uACC4 \uC804\uD658 -> ").concat(this.currentPhase, " (Day ").concat(this.dayCount, ")"));
    // Î™®Îì† ÌîåÎ†àÏù¥Ïñ¥Ïùò Í≤åÏûÑ ÏÉÅÌÉú ÏúÑÏ†Ø ÏóÖÎç∞Ïù¥Ìä∏
    this.updateAllGameStatusWidgets();
    // Îã®Í≥ÑÎ≥Ñ Ïï°ÏÖò Ïã§Ìñâ
    this.executePhaseActions();
  };
  /**
   * Í∞Å Îã®Í≥ÑÏóê Îî∞Î•∏ ÌñâÎèôÏùÑ Ï∂îÏÉÅÌôîÌïòÏó¨ Ï≤òÎ¶¨Ìï©ÎãàÎã§.
   */
  GameFlowManager.prototype.executePhaseActions = function () {
    var _this = this;
    if (!this.room) return;
    switch (this.currentPhase) {
      case MafiaPhase.NIGHT:
        {
          App.sayToAll("Room ".concat(this.room.id, ": \uBC24 \uB2E8\uACC4 - \uB9C8\uD53C\uC544\uAC00 \uD76C\uC0DD\uC790\uB97C \uC120\uD0DD\uD569\uB2C8\uB2E4."));
          // Ìà¨Ìëú Í≤∞Í≥º Ï¥àÍ∏∞Ìôî
          this.voteResults = {};
          this.playerVotes = {};
          this.room.actionToRoomPlayers(function (player) {
            var _a;
            var gamePlayer = (0, Common_1.getPlayerById)(player.id);
            if (!gamePlayer) {
              player.isAlive = false;
              return;
            }
            // Î∞§ Ïï°ÏÖò ÏúÑÏ†Ø ÌëúÏãú
            if (player.isAlive) {
              // Î∞§ Ïï°ÏÖò ÏúÑÏ†Ø ÏÉùÏÑ±
              gamePlayer.tag.widget.nightAction = gamePlayer.showWidget("widgets/night_action.html", "middle", 0, 0);
              // Ï¥àÍ∏∞Ìôî Î©îÏãúÏßÄ Ï†ÑÏÜ°
              gamePlayer.tag.widget.nightAction.sendMessage({
                type: 'init',
                isMobile: gamePlayer.isMobile,
                isTablet: gamePlayer.isTablet
              });
              // Î∞§ Ïï°ÏÖò ÏúÑÏ†ØÏóê Îç∞Ïù¥ÌÑ∞ Ï†ÑÏÜ°
              gamePlayer.tag.widget.nightAction.sendMessage({
                type: 'init',
                players: ((_a = _this.room) === null || _a === void 0 ? void 0 : _a.players) || [],
                myPlayerId: player.id,
                role: player.jobId,
                timeLimit: exports.phaseDurations[MafiaPhase.NIGHT]
              });
              // Î∞§ Ïï°ÏÖò ÏúÑÏ†Ø Î©îÏãúÏßÄ Ï≤òÎ¶¨
              gamePlayer.tag.widget.nightAction.onMessage.Add(function (player, data) {
                var mafiaPlayer = player.tag.mafiaPlayer;
                if (data.type === "kill" && (mafiaPlayer === null || mafiaPlayer === void 0 ? void 0 : mafiaPlayer.jobId) === JobTypes_1.JobId.MAFIA) {
                  _this.mafiaAction(data.targetId);
                } else if (data.type === "investigate" && (mafiaPlayer === null || mafiaPlayer === void 0 ? void 0 : mafiaPlayer.jobId) === JobTypes_1.JobId.POLICE) {
                  _this.policeAction(data.targetId, player);
                } else if (data.type === "heal" && (mafiaPlayer === null || mafiaPlayer === void 0 ? void 0 : mafiaPlayer.jobId) === JobTypes_1.JobId.DOCTOR) {
                  _this.doctorAction(data.targetId);
                } else if (data.type === "close") {
                  player.tag.widget.nightAction.destroy();
                  player.tag.widget.nightAction = null;
                }
              });
            }
          });
        }
        break;
      case MafiaPhase.DAY:
        {
          // Î∞§ Ïï°ÏÖò Í≤∞Í≥º ÌèâÍ∞Ä
          this.evaluateNightActions();
          App.sayToAll("Room ".concat(this.room.id, ": \uB0AE \uB2E8\uACC4 - \uD50C\uB808\uC774\uC5B4\uB4E4\uC774 \uD1A0\uB860\uC744 \uC9C4\uD589\uD569\uB2C8\uB2E4."));
          this.room.actionToRoomPlayers(function (player) {
            var gamePlayer = (0, Common_1.getPlayerById)(player.id);
            if (!gamePlayer) {
              player.isAlive = false;
              return;
            }
            // Î∞§ Ïï°ÏÖò ÏúÑÏ†Ø Ï†úÍ±∞
            if (gamePlayer.tag.widget.nightAction) {
              gamePlayer.tag.widget.nightAction.destroy();
              gamePlayer.tag.widget.nightAction = null;
            }
            // ÌîåÎ†àÏù¥Ïñ¥ Ï†ïÎ≥¥ Ï†ÄÏû•
            gamePlayer.tag.mafiaPlayer = player;
          });
          // ÏäπÎ¶¨ Ï°∞Í±¥ Ï≤¥ÌÅ¨
          this.checkWinCondition();
        }
        break;
      case MafiaPhase.VOTING:
        {
          App.sayToAll("Room ".concat(this.room.id, ": \uD22C\uD45C \uB2E8\uACC4 - \uB9C8\uD53C\uC544\uB85C \uC758\uC2EC\uB418\uB294 \uD50C\uB808\uC774\uC5B4\uC5D0\uAC8C \uD22C\uD45C\uD558\uC138\uC694."));
          // Ìà¨Ìëú Í≤∞Í≥º Ï¥àÍ∏∞Ìôî
          this.voteResults = {};
          this.playerVotes = {};
          this.room.actionToRoomPlayers(function (player) {
            var _a;
            var gamePlayer = (0, Common_1.getPlayerById)(player.id);
            if (!gamePlayer) {
              player.isAlive = false;
              return;
            }
            // Ìà¨Ìëú ÏúÑÏ†Ø ÌëúÏãú (ÏÇ¥ÏïÑÏûàÎäî ÌîåÎ†àÏù¥Ïñ¥Îßå)
            if (player.isAlive) {
              // Ìà¨Ìëú ÏúÑÏ†Ø ÏÉùÏÑ±
              gamePlayer.tag.widget.voteWidget = gamePlayer.showWidget("widgets/vote_widget.html", "middle", 0, 0);
              // Ï¥àÍ∏∞Ìôî Î©îÏãúÏßÄ Ï†ÑÏÜ°
              gamePlayer.tag.widget.voteWidget.sendMessage({
                type: 'init',
                isMobile: gamePlayer.isMobile,
                isTablet: gamePlayer.isTablet
              });
              // Ìà¨Ìëú ÏúÑÏ†ØÏóê Îç∞Ïù¥ÌÑ∞ Ï†ÑÏÜ°
              gamePlayer.tag.widget.voteWidget.sendMessage({
                type: 'init',
                players: ((_a = _this.room) === null || _a === void 0 ? void 0 : _a.players) || [],
                myPlayerId: player.id,
                timeLimit: exports.phaseDurations[MafiaPhase.VOTING]
              });
              // Ìà¨Ìëú ÏúÑÏ†Ø Î©îÏãúÏßÄ Ï≤òÎ¶¨
              gamePlayer.tag.widget.voteWidget.onMessage.Add(function (player, data) {
                if (data.type === "vote") {
                  _this.processVote(player.id, data.targetId);
                } else if (data.type === "close") {
                  player.tag.widget.voteWidget.destroy();
                  player.tag.widget.voteWidget = null;
                }
              });
            }
          });
        }
        break;
      default:
        App.sayToAll("Room ".concat(this.room.id, ": \uC54C \uC218 \uC5C6\uB294 \uB2E8\uACC4\uC785\uB2C8\uB2E4."));
    }
    if (this.dayCount == 0) this.dayCount = 1;
  };
  /**
   * Ìà¨Ìëú Ï≤òÎ¶¨
   * @param voterId Ìà¨ÌëúÌïú ÌîåÎ†àÏù¥Ïñ¥ ID
   * @param targetId Ìà¨Ìëú ÎåÄÏÉÅ ÌîåÎ†àÏù¥Ïñ¥ ID
   */
  GameFlowManager.prototype.processVote = function (voterId, targetId) {
    // Ïù¥ÎØ∏ Ìà¨ÌëúÌïú Í≤ΩÏö∞ Ïù¥Ï†Ñ Ìà¨Ìëú Ï∑®ÏÜå
    if (this.playerVotes[voterId]) {
      var previousTarget = this.playerVotes[voterId];
      this.voteResults[previousTarget]--;
    }
    // ÏÉà Ìà¨Ìëú Îì±Î°ù
    this.playerVotes[voterId] = targetId;
    // Ìà¨Ìëú Í≤∞Í≥º ÏóÖÎç∞Ïù¥Ìä∏
    if (!this.voteResults[targetId]) {
      this.voteResults[targetId] = 1;
    } else {
      this.voteResults[targetId]++;
    }
    // Î™®Îì† ÌîåÎ†àÏù¥Ïñ¥ÏóêÍ≤å Ìà¨Ìëú Í≤∞Í≥º ÏóÖÎç∞Ïù¥Ìä∏
    this.updateVoteResults();
    // Î™®Îì† ÌîåÎ†àÏù¥Ïñ¥Í∞Ä Ìà¨ÌëúÌñàÎäîÏßÄ ÌôïÏù∏
    var alivePlayers = this.room.players.filter(function (p) {
      return p.isAlive;
    });
    var votedPlayers = Object.keys(this.playerVotes).length;
    if (votedPlayers >= alivePlayers.length) {
      // Î™®Îì† ÌîåÎ†àÏù¥Ïñ¥Í∞Ä Ìà¨Ìëú ÏôÑÎ£å
      this.finalizeVoting();
    }
  };
  /**
   * Î™®Îì† ÌîåÎ†àÏù¥Ïñ¥ÏóêÍ≤å Ìà¨Ìëú Í≤∞Í≥º ÏóÖÎç∞Ïù¥Ìä∏
   */
  GameFlowManager.prototype.updateVoteResults = function () {
    var _this = this;
    if (!this.room) return;
    this.room.actionToRoomPlayers(function (player) {
      var gamePlayer = (0, Common_1.getPlayerById)(player.id);
      if (!gamePlayer || !gamePlayer.tag.widget.voteWidget) return;
      gamePlayer.tag.widget.voteWidget.sendMessage({
        type: 'updateVotes',
        votes: _this.voteResults
      });
    });
  };
  /**
   * Ìà¨Ìëú Ï¢ÖÎ£å Î∞è Í≤∞Í≥º Ï≤òÎ¶¨
   */
  GameFlowManager.prototype.finalizeVoting = function () {
    var _this = this;
    if (!this.room) return;
    // Í∞ÄÏû• ÎßéÏùÄ ÌëúÎ•º Î∞õÏùÄ ÌîåÎ†àÏù¥Ïñ¥ Ï∞æÍ∏∞
    var maxVotes = 0;
    var eliminatedPlayerId = null;
    for (var _i = 0, _a = Object.entries(this.voteResults); _i < _a.length; _i++) {
      var _b = _a[_i],
        playerId = _b[0],
        votes = _b[1];
      if (votes > maxVotes) {
        maxVotes = votes;
        eliminatedPlayerId = playerId;
      }
    }
    // Ìà¨Ìëú Í≤∞Í≥º ÌëúÏãú
    this.room.actionToRoomPlayers(function (player) {
      var gamePlayer = (0, Common_1.getPlayerById)(player.id);
      if (!gamePlayer || !gamePlayer.tag.widget.voteWidget) return;
      gamePlayer.tag.widget.voteWidget.sendMessage({
        type: 'showResults',
        results: _this.voteResults
      });
    });
    // 3Ï¥à ÌõÑ Ìà¨Ìëú ÏúÑÏ†Ø Ï†úÍ±∞ Î∞è Îã§Ïùå Îã®Í≥ÑÎ°ú
    App.runLater(function () {
      if (!_this.room) return;
      // Ìà¨Ìëú ÏúÑÏ†Ø Ï†úÍ±∞
      _this.room.actionToRoomPlayers(function (player) {
        var gamePlayer = (0, Common_1.getPlayerById)(player.id);
        if (!gamePlayer || !gamePlayer.tag.widget.voteWidget) return;
        gamePlayer.tag.widget.voteWidget.destroy();
        gamePlayer.tag.widget.voteWidget = null;
      });
      // ÌîåÎ†àÏù¥Ïñ¥ ÌÉàÎùΩ Ï≤òÎ¶¨
      if (eliminatedPlayerId) {
        var targetPlayer = _this.room.players.find(function (p) {
          return p.id === eliminatedPlayerId;
        });
        if (targetPlayer) {
          targetPlayer.isAlive = false;
          App.sayToAll("Room ".concat(_this.room.id, ": ").concat(targetPlayer.name, "(").concat(targetPlayer.jobId, ") \uD50C\uB808\uC774\uC5B4\uAC00 \uD22C\uD45C\uB85C \uD0C8\uB77D\uD588\uC2B5\uB2C8\uB2E4."));
        }
      }
      // ÏäπÎ¶¨ Ï°∞Í±¥ Ï≤¥ÌÅ¨
      _this.checkWinCondition();
      // Îã§Ïùå Îã®Í≥ÑÎ°ú
      if (_this.state === GameState.IN_PROGRESS) {
        _this.nextPhase();
      }
    }, 3);
  };
  /**
   * Î∞§ Îã®Í≥ÑÏóêÏÑú ÎßàÌîºÏïÑÍ∞Ä Ìù¨ÏÉù ÎåÄÏÉÅÏùÑ ÏÑ†ÌÉùÌï©ÎãàÎã§.
   * @param targetPlayerId ÏÑ†ÌÉùÌïú ÎåÄÏÉÅ ÌîåÎ†àÏù¥Ïñ¥Ïùò ID
   */
  GameFlowManager.prototype.mafiaAction = function (targetPlayerId) {
    if (this.currentPhase !== MafiaPhase.NIGHT) {
      return;
    }
    this.nightActions.push({
      playerId: targetPlayerId,
      targetId: targetPlayerId,
      jobId: JobTypes_1.JobId.MAFIA
    });
  };
  /**
   * Î∞§ Îã®Í≥ÑÏóêÏÑú ÏùòÏÇ¨Í∞Ä Î≥¥Ìò∏Ìï† ÎåÄÏÉÅÏùÑ ÏÑ†ÌÉùÌï©ÎãàÎã§.
   * @param targetPlayerId ÏÑ†ÌÉùÌïú Î≥¥Ìò∏ ÎåÄÏÉÅ ÌîåÎ†àÏù¥Ïñ¥Ïùò ID
   */
  GameFlowManager.prototype.doctorAction = function (targetPlayerId) {
    if (this.currentPhase !== MafiaPhase.NIGHT) {
      return;
    }
    this.nightActions.push({
      playerId: targetPlayerId,
      targetId: targetPlayerId,
      jobId: JobTypes_1.JobId.DOCTOR
    });
  };
  /**
   * Î∞§ Îã®Í≥ÑÏóêÏÑú Í≤ΩÏ∞∞Ïù¥ Ï°∞ÏÇ¨Ìï† ÎåÄÏÉÅÏùÑ ÏÑ†ÌÉùÌï©ÎãàÎã§.
   * @param targetPlayerId Ï°∞ÏÇ¨Ìï† ÌîåÎ†àÏù¥Ïñ¥Ïùò ID
   * @param policePlayer Í≤ΩÏ∞∞ ÌîåÎ†àÏù¥Ïñ¥
   */
  GameFlowManager.prototype.policeAction = function (targetPlayerId, policePlayer) {
    if (this.currentPhase !== MafiaPhase.NIGHT) {
      return;
    }
    this.nightActions.push({
      playerId: targetPlayerId,
      targetId: targetPlayerId,
      jobId: JobTypes_1.JobId.POLICE
    });
    // ÎåÄÏÉÅ ÌîåÎ†àÏù¥Ïñ¥ Ï∞æÍ∏∞
    var targetPlayer = this.room.players.find(function (p) {
      return p.id === targetPlayerId;
    });
    if (!targetPlayer) return;
    // Ï°∞ÏÇ¨ Í≤∞Í≥º Ï†ÑÏÜ°
    var isMafia = targetPlayer.jobId === JobTypes_1.JobId.MAFIA;
    // Í≤ΩÏ∞∞ ÌîåÎ†àÏù¥Ïñ¥ÏóêÍ≤å Í≤∞Í≥º Ï†ÑÏÜ°
    if (policePlayer.tag.widget.nightAction) {
      policePlayer.tag.widget.nightAction.sendMessage({
        type: 'investigationResult',
        isMafia: isMafia
      });
    }
  };
  /**
   * Î∞§ Îã®Í≥Ñ Ïï°ÏÖò ÌèâÍ∞Ä
   * - ÎßàÌîºÏïÑÍ∞Ä ÏÑ†ÌÉùÌïú ÎåÄÏÉÅÏù¥ ÏùòÏÇ¨Ïùò Î≥¥Ìò∏ ÎåÄÏÉÅÍ≥º ÎèôÏùºÌïòÎ©¥ Î≥¥Ìò∏ ÏÑ±Í≥µ.
   * - Í∑∏Î†áÏßÄ ÏïäÏúºÎ©¥ Ìï¥Îãπ ÌîåÎ†àÏù¥Ïñ¥Î•º ÏÇ¨Îßù Ï≤òÎ¶¨Ìï©ÎãàÎã§.
   */
  GameFlowManager.prototype.evaluateNightActions = function () {
    var _this = this;
    // Î∞§ Ïï°ÏÖò Ï≤òÎ¶¨ Î°úÏßÅ
    var killedPlayers = [];
    var protectedPlayers = [];
    var blockedPlayers = [];
    // Î≥¥Ìò∏ Ïï°ÏÖò Î®ºÏ†Ä Ï≤òÎ¶¨
    this.nightActions.forEach(function (action) {
      var job = (0, JobTypes_1.getJobById)(action.jobId);
      if (!job) return;
      // ÏùòÏÇ¨ Îì±Ïùò Î≥¥Ìò∏ Îä•Î†•
      if (job.abilityType === JobTypes_1.JobAbilityType.PROTECT) {
        protectedPlayers.push(action.targetId);
      }
      // Ìà¨Ìëú Î∞©Ìï¥ Îä•Î†•
      if (job.abilityType === JobTypes_1.JobAbilityType.BLOCK) {
        blockedPlayers.push(action.targetId);
      }
    });
    // ÏÇ¥Ìï¥ Ïï°ÏÖò Ï≤òÎ¶¨
    this.nightActions.forEach(function (action) {
      var job = (0, JobTypes_1.getJobById)(action.jobId);
      if (!job) return;
      // ÎßàÌîºÏïÑ Îì±Ïùò ÏÇ¥Ìï¥ Îä•Î†•
      if (job.abilityType === JobTypes_1.JobAbilityType.KILL) {
        var target = _this.room.players.find(function (p) {
          return p.id === action.targetId;
        });
        if (!target || !target.isAlive) return;
        // Î≥¥Ìò∏ÎêòÏßÄ ÏïäÏïòÍ≥†, Î©¥Ïó≠Ïù¥ ÏóÜÏúºÎ©¥ ÏÇ¨Îßù
        if (!protectedPlayers.includes(action.targetId) && !target.isImmune) {
          killedPlayers.push(action.targetId);
        } else if (target.isImmune) {
          // Î©¥Ïó≠Ïù¥ ÏûàÏúºÎ©¥ Î©¥Ïó≠ ÏÜåÎ™®
          target.isImmune = false;
        }
      }
    });
    // Ìà¨Ìëú Î∞©Ìï¥ ÏÉÅÌÉú Ï†ÅÏö©
    blockedPlayers.forEach(function (playerId) {
      var player = _this.room.players.find(function (p) {
        return p.id === playerId;
      });
      if (player) {
        player.isBlocked = true;
      }
    });
    // ÏÇ¨Îßù Ï≤òÎ¶¨
    killedPlayers.forEach(function (playerId) {
      var player = _this.room.players.find(function (p) {
        return p.id === playerId;
      });
      if (player) {
        player.isAlive = false;
        // ÏÇ¨Îßù Î©îÏãúÏßÄ ÌëúÏãú
        App.showCenterLabel("".concat(player.name, "\uB2D8\uC774 \uC0AC\uB9DD\uD588\uC2B5\uB2C8\uB2E4."));
        // ÏÇ¨ÎßùÌïú ÌîåÎ†àÏù¥Ïñ¥ÏóêÍ≤å Î©îÏãúÏßÄ Ï†ÑÏÜ°
        var gamePlayer = _this.room.getGamePlayer(playerId);
        if (gamePlayer) {
          gamePlayer.tag.widget.main.sendMessage({
            type: "player_died",
            message: "ÎãπÏã†ÏùÄ ÏÇ¨ÎßùÌñàÏäµÎãàÎã§."
          });
        }
      }
    });
    // Î∞§ Ïï°ÏÖò Ï¥àÍ∏∞Ìôî
    this.nightActions = [];
    // ÏäπÎ¶¨ Ï°∞Í±¥ ÌôïÏù∏
    this.checkWinCondition();
  };
  /**
   * ÏäπÎ¶¨ Ï°∞Í±¥ Ï≤¥ÌÅ¨
   * - ÏÇ¥ÏïÑÏûàÎäî ÌîåÎ†àÏù¥Ïñ¥ Ï§ë ÎßàÌîºÏïÑÍ∞Ä 0Î™ÖÏù¥Î©¥ ÏãúÎØº ÏäπÎ¶¨
   * - ÎßàÌîºÏïÑ ÏàòÍ∞Ä ÏãúÎØº(Î∞è Í∏∞ÌÉÄ) Ïàò Ïù¥ÏÉÅÏù¥Î©¥ ÎßàÌîºÏïÑ ÏäπÎ¶¨
   */
  GameFlowManager.prototype.checkWinCondition = function () {
    var _this = this;
    var alivePlayers = this.room.players.filter(function (p) {
      return p.isAlive;
    });
    var aliveMafia = alivePlayers.filter(function (p) {
      return _this.isMafia(p);
    });
    var aliveCitizens = alivePlayers.filter(function (p) {
      return !_this.isMafia(p);
    });
    // ÎßàÌîºÏïÑÍ∞Ä Î™®Îëê ÏÇ¨ÎßùÌïú Í≤ΩÏö∞ ÏãúÎØº ÏäπÎ¶¨
    if (aliveMafia.length === 0) {
      this.showGameResult(JobTypes_1.JobTeam.CITIZEN);
      return true;
    }
    // ÎßàÌîºÏïÑ ÏàòÍ∞Ä ÏãúÎØº Ïàò Ïù¥ÏÉÅÏù∏ Í≤ΩÏö∞ ÎßàÌîºÏïÑ ÏäπÎ¶¨
    if (aliveMafia.length >= aliveCitizens.length) {
      this.showGameResult(JobTypes_1.JobTeam.MAFIA);
      return true;
    }
    return false;
  };
  /**
   * Í≤åÏûÑ Í≤∞Í≥º ÌëúÏãú
   * @param winnerTeam ÏäπÎ¶¨Ìïú ÌåÄ
   */
  GameFlowManager.prototype.showGameResult = function (winnerTeam) {
    var _this = this;
    // Í≤åÏûÑ Ï¢ÖÎ£å ÏÉÅÌÉúÎ°ú Î≥ÄÍ≤Ω
    this.state = GameState.ENDED;
    // ÏäπÎ¶¨ Î©îÏãúÏßÄ ÌëúÏãú
    var winMessage = winnerTeam === JobTypes_1.JobTeam.MAFIA ? "ÎßàÌîºÏïÑ ÌåÄÏù¥ ÏäπÎ¶¨ÌñàÏäµÎãàÎã§!" : "ÏãúÎØº ÌåÄÏù¥ ÏäπÎ¶¨ÌñàÏäµÎãàÎã§!";
    App.showCenterLabel(winMessage);
    // Î™®Îì† ÌîåÎ†àÏù¥Ïñ¥ÏóêÍ≤å Í≤∞Í≥º Î©îÏãúÏßÄ Ï†ÑÏÜ°
    this.room.players.forEach(function (player) {
      var gamePlayer = _this.room.getGamePlayer(player.id);
      if (gamePlayer) {
        var job = (0, JobTypes_1.getJobById)(player.jobId);
        var isWinner = (job === null || job === void 0 ? void 0 : job.team) === winnerTeam;
        gamePlayer.tag.widget.main.sendMessage({
          type: "game_result",
          winner: winnerTeam,
          isWinner: isWinner,
          message: winMessage
        });
      }
    });
    // 5Ï¥à ÌõÑ Í≤åÏûÑ Î¶¨ÏÖã
    setTimeout(function () {
      _this.resetGame();
    }, 5000);
  };
  // Í≤åÏûÑ Î¶¨ÏÖã: Í≤åÏûÑ ÏÉÅÌÉúÏôÄ Îã®Í≥Ñ Îì±ÏùÑ Ï¥àÍ∏∞ÌôîÌï©ÎãàÎã§.
  GameFlowManager.prototype.resetGame = function () {
    if (!this.room) return;
    this.state = GameState.WAITING;
    if (this.phaseCycle) {
      this.setPhase(this.phaseCycle[0]);
    } else {
      this.setPhase(MafiaPhase.DAY);
    }
    this.dayCount = 1;
    // Î™®Îì† ÏúÑÏ†Ø Ï†úÍ±∞
    this.room.actionToRoomPlayers(function (player) {
      var gamePlayer = (0, Common_1.getPlayerById)(player.id);
      if (!gamePlayer) return;
      if (gamePlayer.tag.widget) {
        if (gamePlayer.tag.widget.gameStatus) {
          gamePlayer.tag.widget.gameStatus.destroy();
          gamePlayer.tag.widget.gameStatus = null;
        }
        if (gamePlayer.tag.widget.nightAction) {
          gamePlayer.tag.widget.nightAction.destroy();
          gamePlayer.tag.widget.nightAction = null;
        }
        if (gamePlayer.tag.widget.voteWidget) {
          gamePlayer.tag.widget.voteWidget.destroy();
          gamePlayer.tag.widget.voteWidget = null;
        }
      }
    });
    App.sayToAll("Room ".concat(this.room.id, ": \uAC8C\uC784\uC774 \uB9AC\uC14B\uB418\uC5C8\uC2B5\uB2C8\uB2E4."));
  };
  GameFlowManager.prototype.setPhase = function (phase) {
    this.currentPhase = phase;
    this.phaseTimer = exports.phaseDurations[this.currentPhase];
  };
  GameFlowManager.prototype.getCurrentPhase = function () {
    return this.currentPhase;
  };
  GameFlowManager.prototype.isGameInProgress = function () {
    return this.state === GameState.IN_PROGRESS;
  };
  // ÌîåÎ†àÏù¥Ïñ¥Ïùò ÌåÄ ÌôïÏù∏ (ÎßàÌîºÏïÑ Ïó¨Î∂Ä)
  GameFlowManager.prototype.isMafia = function (player) {
    var job = (0, JobTypes_1.getJobById)(player.jobId);
    return (job === null || job === void 0 ? void 0 : job.team) === JobTypes_1.JobTeam.MAFIA;
  };
  // Îä•Î†• ÏÇ¨Ïö© Ï≤òÎ¶¨
  GameFlowManager.prototype.processAbility = function (playerId, targetId) {
    if (!this.room) return;
    var player = this.room.getPlayer(playerId);
    if (!player || !player.isAlive) return;
    var job = (0, JobTypes_1.getJobById)(player.jobId);
    if (!job) return;
    // Îä•Î†• ÏÇ¨Ïö© ÌöüÏàò ÌôïÏù∏
    if (job.usesPerGame !== undefined && player.abilityUses !== undefined) {
      if (player.abilityUses <= 0) return;
      player.abilityUses--;
    }
    // Î∞§ Îä•Î†•Ïù∏Îç∞ ÌòÑÏû¨ Î∞§Ïù¥ ÏïÑÎãàÎ©¥ ÏÇ¨Ïö© Î∂àÍ∞Ä
    if (job.nightAbility && this.currentPhase !== MafiaPhase.NIGHT) return;
    // ÎÇÆ Îä•Î†•Ïù∏Îç∞ ÌòÑÏû¨ ÎÇÆÏù¥ ÏïÑÎãàÎ©¥ ÏÇ¨Ïö© Î∂àÍ∞Ä
    if (job.dayAbility && this.currentPhase !== MafiaPhase.DAY) return;
    // Îä•Î†• ÏÇ¨Ïö© Í∏∞Î°ù
    this.nightActions.push({
      playerId: playerId,
      targetId: targetId,
      jobId: player.jobId
    });
    // ÌîåÎ†àÏù¥Ïñ¥ÏóêÍ≤å Îä•Î†• ÏÇ¨Ïö© ÌôïÏù∏ Î©îÏãúÏßÄ Ï†ÑÏÜ°
    var gamePlayer = this.room.getGamePlayer(playerId);
    if (gamePlayer) {
      gamePlayer.tag.widget.main.sendMessage({
        type: "ability_used",
        success: true,
        message: "".concat(job.name, " \uB2A5\uB825\uC744 \uC0AC\uC6A9\uD588\uC2B5\uB2C8\uB2E4.")
      });
    }
  };
  return GameFlowManager;
}();
exports.GameFlowManager = GameFlowManager;

/***/ }),

/***/ 401:
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {



var __extends = this && this.__extends || function () {
  var extendStatics = function (d, b) {
    extendStatics = Object.setPrototypeOf || {
      __proto__: []
    } instanceof Array && function (d, b) {
      d.__proto__ = b;
    } || function (d, b) {
      for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p];
    };
    return extendStatics(d, b);
  };
  return function (d, b) {
    if (typeof b !== "function" && b !== null) throw new TypeError("Class extends value " + String(b) + " is not a constructor or null");
    extendStatics(d, b);
    function __() {
      this.constructor = d;
    }
    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
  };
}();
Object.defineProperty(exports, "__esModule", ({
  value: true
}));
exports.Game = void 0;
var Common_1 = __webpack_require__(169);
var Localizer_1 = __webpack_require__(773);
var GameBase_1 = __webpack_require__(771);
var GameRoomManager_1 = __webpack_require__(500);
var JobTypes_1 = __webpack_require__(669);
var defaultGameModes_1 = __webpack_require__(764);
var ROOM_COUNT = 1;
var Game = /** @class */function (_super) {
  __extends(Game, _super);
  function Game() {
    var _this = _super.call(this) || this;
    _this.mafiaGameRoomManager = new GameRoomManager_1.GameRoomManager();
    _this.addOnStartCallback(_this.onStart.bind(_this));
    _this.addOnJoinPlayerCallback(_this.onJoinPlayer.bind(_this));
    _this.addOnLeavePlayerCallback(_this.onLeavePlayer.bind(_this));
    _this.addOnUpdateCallback(_this.update.bind(_this));
    _this.addOnDestroyCallback(_this.onDestroy.bind(_this));
    // Í≤åÏûÑ Î™®Îìú Îì±Î°ù
    var gameModes = (0, defaultGameModes_1.createDefaultGameModes)();
    gameModes.forEach(function (mode) {
      _this.mafiaGameRoomManager.registerGameMode(mode);
    });
    // Í∏∞Î≥∏ Í≤åÏûÑÎ∞© ÏÉùÏÑ±
    var defaultGameMode = gameModes.find(function (mode) {
      return mode.getId() === "classic";
    }) || gameModes[0];
    _this.mafiaGameRoomManager.createRoom({
      title: "Í∏∞Î≥∏ Í≤åÏûÑÎ∞©",
      gameMode: defaultGameMode,
      maxPlayers: 8
    });
    return _this;
  }
  Game.create = function () {
    if (!Game._instance) {
      Game._instance = new Game();
    }
  };
  Game.prototype.onStart = function () {
    App.enableFreeView = false;
    App.sendUpdated();
  };
  Game.prototype.onJoinPlayer = function (player) {
    player.tag = {
      widget: {},
      mafiaPlayer: null
    };
    // Î°úÏª¨ÎùºÏù¥Ïßï
    Localizer_1.Localizer.prepareLocalizationContainer(player);
    //@ts-ignore
    var customData = (0, Common_1.parseJsonString)(player.customData);
    // Î°úÎπÑ ÏúÑÏ†Ø ÌëúÏãú
    this.showLobbyWidget(player);
  };
  /**
   * Î°úÎπÑ ÏúÑÏ†ØÏùÑ ÌëúÏãúÌï©ÎãàÎã§.
   * @param player ÌîåÎ†àÏù¥Ïñ¥
   */
  Game.prototype.showLobbyWidget = function (player) {
    var _this = this;
    // Ïù¥ÎØ∏ Î©îÏù∏ ÏúÑÏ†ØÏù¥ ÏûàÏúºÎ©¥ Ï†úÍ±∞
    if (player.tag.widget.main) {
      player.tag.widget.main.destroy();
    }
    // Î°úÎπÑ ÏúÑÏ†Ø ÏÉùÏÑ±
    player.tag.widget.main = player.showWidget("widgets/lobby_widget.html", "middle", 0, 0);
    // Ï¥àÍ∏∞Ìôî Î©îÏãúÏßÄ Ï†ÑÏÜ°
    player.tag.widget.main.sendMessage({
      type: "init",
      message: "ÏΩîÎìú ÎßàÌîºÏïÑ",
      isMobile: player.isMobile,
      isTablet: player.isTablet
    });
    // Í≤åÏûÑ Î∞© Ï†ïÎ≥¥ Ï†ÑÏÜ°
    var rooms = [];
    for (var i = 1; i <= ROOM_COUNT; i++) {
      var room = this.mafiaGameRoomManager.getRoom(i.toString());
      if (room) {
        rooms.push({
          id: room.id,
          title: room.title,
          playerCount: room.getPlayersCount(),
          maxPlayers: room.maxPlayers,
          gameMode: room.gameMode.getName(),
          isInProgress: room.flowManager.isGameInProgress()
        });
      }
    }
    player.tag.widget.main.sendMessage({
      type: "updateRooms",
      rooms: rooms
    });
    // Î°úÎπÑ ÏúÑÏ†Ø Î©îÏãúÏßÄ Ï≤òÎ¶¨ ÏÑ§Ï†ï
    player.tag.widget.main.onMessage.Add(function (player, data) {
      if (data.type === "showRoleDetail" && data.role) {
        _this.showRoleCard(player, data.role);
      } else if (data.type === "startGame") {
        _this.showGameModeSelect(player);
      } else if (data.type === "joinRoom" && data.roomId) {
        var room = _this.mafiaGameRoomManager.getRoom(data.roomId);
        if (room) {
          room.joinPlayer(player);
          // Î∞© Ï∞∏Í∞Ä ÌõÑ UI ÏóÖÎç∞Ïù¥Ìä∏
          player.tag.widget.main.sendMessage({
            type: "joinedRoom",
            roomId: data.roomId,
            roomInfo: {
              id: room.id,
              title: room.title,
              playerCount: room.getPlayersCount(),
              maxPlayers: room.maxPlayers,
              gameMode: room.gameMode.getName(),
              isInProgress: room.flowManager.isGameInProgress()
            }
          });
          // Î™®Îì† ÌîåÎ†àÏù¥Ïñ¥ÏóêÍ≤å Î∞© Ï†ïÎ≥¥ ÏóÖÎç∞Ïù¥Ìä∏ Ï†ÑÏÜ°
          _this.updateRoomInfo();
        }
      } else if (data.type === "leaveRoom") {
        if (player.tag.roomInfo) {
          var roomNum = player.tag.roomInfo.roomNum;
          _this.mafiaGameRoomManager.getRoom(roomNum.toString()).leavePlayer(player.id);
          // Î∞© Ìá¥Ïû• ÌõÑ UI ÏóÖÎç∞Ïù¥Ìä∏
          player.tag.widget.main.sendMessage({
            type: "leftRoom"
          });
          // Î™®Îì† ÌîåÎ†àÏù¥Ïñ¥ÏóêÍ≤å Î∞© Ï†ïÎ≥¥ ÏóÖÎç∞Ïù¥Ìä∏ Ï†ÑÏÜ°
          _this.updateRoomInfo();
        }
      } else if (data.type === "refreshRooms") {
        // Í≤åÏûÑ Î∞© Ï†ïÎ≥¥ ÏóÖÎç∞Ïù¥Ìä∏ Ï†ÑÏÜ°
        var rooms_1 = [];
        for (var i = 1; i <= ROOM_COUNT; i++) {
          var room = _this.mafiaGameRoomManager.getRoom(i.toString());
          if (room) {
            rooms_1.push({
              id: room.id,
              title: room.title,
              playerCount: room.getPlayersCount(),
              maxPlayers: room.maxPlayers,
              gameMode: room.gameMode.getName(),
              isInProgress: room.flowManager.isGameInProgress()
            });
          }
        }
        player.tag.widget.main.sendMessage({
          type: "updateRooms",
          rooms: rooms_1
        });
      }
    });
  };
  /**
   * Í≤åÏûÑ Î™®Îìú ÏÑ†ÌÉù ÏúÑÏ†ØÏùÑ ÌëúÏãúÌï©ÎãàÎã§.
   * @param player ÌîåÎ†àÏù¥Ïñ¥
   */
  Game.prototype.showGameModeSelect = function (player) {
    var _this = this;
    // Ïù¥ÎØ∏ Í≤åÏûÑ Î™®Îìú ÏÑ†ÌÉù ÏúÑÏ†ØÏù¥ ÏûàÏúºÎ©¥ Ï†úÍ±∞
    if (player.tag.widget.gameModeSelect) {
      player.tag.widget.gameModeSelect.destroy();
    }
    // Í≤åÏûÑ Î™®Îìú ÏÑ†ÌÉù ÏúÑÏ†Ø ÏÉùÏÑ±
    player.tag.widget.gameModeSelect = player.showWidget("widgets/game_mode_select.html", "middle", 0, 0);
    // Ï¥àÍ∏∞Ìôî Î©îÏãúÏßÄ Ï†ÑÏÜ°
    player.tag.widget.gameModeSelect.sendMessage({
      type: 'init',
      isMobile: player.isMobile,
      isTablet: player.isTablet
    });
    // Í≤åÏûÑ Î™®Îìú Ï†ïÎ≥¥ Ï†ÑÏÜ°
    player.tag.widget.gameModeSelect.sendMessage({
      type: 'init_game_modes',
      modes: JobTypes_1.GAME_MODES,
      jobs: JobTypes_1.JOBS
    });
    // Í≤åÏûÑ Î™®Îìú ÏÑ†ÌÉù ÏúÑÏ†Ø Î©îÏãúÏßÄ Ï≤òÎ¶¨
    player.tag.widget.gameModeSelect.onMessage.Add(function (player, data) {
      if (data.type === "cancel_mode_select") {
        player.tag.widget.gameModeSelect.destroy();
        player.tag.widget.gameModeSelect = null;
      } else if (data.type === "select_game_mode") {
        var modeId = data.modeId;
        var room = _this.mafiaGameRoomManager.getRoom("1");
        // Í≤åÏûÑ Î™®Îìú ÏÑ§Ï†ï
        room.flowManager.setGameMode(modeId);
        // Í≤åÏûÑ ÏãúÏûë
        room.flowManager.startGame();
        // ÏúÑÏ†Ø Ï†úÍ±∞
        player.tag.widget.gameModeSelect.destroy();
        player.tag.widget.gameModeSelect = null;
        // Î™®Îì† ÌîåÎ†àÏù¥Ïñ¥ÏóêÍ≤å Î∞© Ï†ïÎ≥¥ ÏóÖÎç∞Ïù¥Ìä∏ Ï†ÑÏÜ°
        _this.updateRoomInfo();
      }
    });
  };
  /**
   * Ïó≠Ìï† Ïπ¥Îìú ÏúÑÏ†ØÏùÑ ÌëúÏãúÌï©ÎãàÎã§.
   * @param player ÌîåÎ†àÏù¥Ïñ¥
   * @param role Ïó≠Ìï†
   */
  Game.prototype.showRoleCard = function (player, role) {
    // Ïù¥ÎØ∏ Ïó≠Ìï† Ïπ¥Îìú ÏúÑÏ†ØÏù¥ ÏûàÏúºÎ©¥ Ï†úÍ±∞
    if (player.tag.widget.roleCard) {
      player.tag.widget.roleCard.destroy();
    }
    // Ïó≠Ìï† Ïπ¥Îìú ÏúÑÏ†Ø ÏÉùÏÑ±
    player.tag.widget.roleCard = player.showWidget("widgets/role_card.html", "middle", 0, 0);
    // Ï¥àÍ∏∞Ìôî Î©îÏãúÏßÄ Ï†ÑÏÜ°
    player.tag.widget.roleCard.sendMessage({
      type: 'init',
      isMobile: player.isMobile,
      isTablet: player.isTablet
    });
    // Ïó≠Ìï† Ï†ïÎ≥¥ Ï†ÑÏÜ°
    player.tag.widget.roleCard.sendMessage({
      type: 'setRole',
      role: role
    });
    // Ïó≠Ìï† Ïπ¥Îìú ÏúÑÏ†Ø Î©îÏãúÏßÄ Ï≤òÎ¶¨
    player.tag.widget.roleCard.onMessage.Add(function (player, data) {
      if (data.type === "close") {
        player.tag.widget.roleCard.destroy();
        player.tag.widget.roleCard = null;
      }
    });
  };
  Game.prototype.onLeavePlayer = function (player) {
    // ÌîåÎ†àÏù¥Ïñ¥Í∞Ä ÏÜçÌïú Î∞©Ïù¥ ÏûàÏúºÎ©¥ Ìï¥Îãπ Î∞©ÏóêÏÑú Ï†úÍ±∞
    if (player.tag.roomInfo) {
      var roomNum = player.tag.roomInfo.roomNum;
      this.mafiaGameRoomManager.getRoom(roomNum.toString()).leavePlayer(player.id);
    }
  };
  Game.prototype.update = function (dt) {
    // Í∞Å Î∞©Ïùò Í≤åÏûÑ ÏÉÅÌÉú ÏóÖÎç∞Ïù¥Ìä∏
    for (var i = 1; i <= ROOM_COUNT; i++) {
      var room = this.mafiaGameRoomManager.getRoom(i.toString());
      if (room && room.flowManager.isGameInProgress()) {
        // ÌÉÄÏù¥Î®∏ ÏóÖÎç∞Ïù¥Ìä∏
        if (room.flowManager.phaseTimer > 0) {
          room.flowManager.phaseTimer -= dt;
          // ÌÉÄÏù¥Î®∏Í∞Ä 0 Ïù¥ÌïòÍ∞Ä ÎêòÎ©¥ Îã§Ïùå Îã®Í≥ÑÎ°ú ÏßÑÌñâ
          if (room.flowManager.phaseTimer <= 0) {
            room.flowManager.nextPhase();
          }
        }
      }
    }
  };
  Game.prototype.onDestroy = function () {
    // Í≤åÏûÑ Ï¢ÖÎ£å Ïãú ÌïÑÏöîÌïú Ï†ïÎ¶¨ ÏûëÏóÖ
  };
  /**
   * Î™®Îì† ÌîåÎ†àÏù¥Ïñ¥ÏóêÍ≤å Î∞© Ï†ïÎ≥¥Î•º ÏóÖÎç∞Ïù¥Ìä∏Ìï©ÎãàÎã§.
   */
  Game.prototype.updateRoomInfo = function () {
    // Í≤åÏûÑ Î∞© Ï†ïÎ≥¥ ÏàòÏßë
    var rooms = [];
    for (var i = 1; i <= ROOM_COUNT; i++) {
      var room = this.mafiaGameRoomManager.getRoom(i.toString());
      if (room) {
        rooms.push({
          id: room.id,
          title: room.title,
          playerCount: room.getPlayersCount(),
          maxPlayers: room.maxPlayers,
          gameMode: room.gameMode.getName(),
          isInProgress: room.flowManager.isGameInProgress()
        });
      }
    }
    // Î™®Îì† ÌîåÎ†àÏù¥Ïñ¥ÏóêÍ≤å ÏóÖÎç∞Ïù¥Ìä∏Îêú Î∞© Ï†ïÎ≥¥ Ï†ÑÏÜ°
    App.players.forEach(function (player) {
      var _a, _b;
      if ((_b = (_a = player.tag) === null || _a === void 0 ? void 0 : _a.widget) === null || _b === void 0 ? void 0 : _b.main) {
        player.tag.widget.main.sendMessage({
          type: "updateRooms",
          rooms: rooms
        });
      }
    });
  };
  return Game;
}(GameBase_1.GameBase);
exports.Game = Game;

/***/ }),

/***/ 500:
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {



var __assign = this && this.__assign || function () {
  __assign = Object.assign || function (t) {
    for (var s, i = 1, n = arguments.length; i < n; i++) {
      s = arguments[i];
      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];
    }
    return t;
  };
  return __assign.apply(this, arguments);
};
Object.defineProperty(exports, "__esModule", ({
  value: true
}));
exports.GameRoomManager = void 0;
var GameRoom_1 = __webpack_require__(727);
/**
 * Í≤åÏûÑÎ∞© Í¥ÄÎ¶¨Ïûê ÌÅ¥ÎûòÏä§
 * Ïó¨Îü¨ Í≤åÏûÑÎ∞©ÏùÑ ÏÉùÏÑ±ÌïòÍ≥† Í¥ÄÎ¶¨Ìï©ÎãàÎã§.
 */
var GameRoomManager = /** @class */function () {
  function GameRoomManager() {
    this.gameRooms = new Map();
    this.gameModes = new Map();
    this.callbacks = {};
    // Í∏∞Î≥∏ ÏÉùÏÑ±Ïûê
  }
  /**
   * Î™®Îì† Í≤åÏûÑÎ∞© Ï°∞Ìöå
   */
  GameRoomManager.prototype.getAllRooms = function () {
    return Array.from(this.gameRooms.values());
  };
  /**
   * ÌäπÏ†ï IDÏùò Í≤åÏûÑÎ∞© Ï°∞Ìöå
   */
  GameRoomManager.prototype.getRoom = function (roomId) {
    return this.gameRooms.get(roomId);
  };
  /**
   * Í≤åÏûÑÎ∞© ÏÉùÏÑ±
   */
  GameRoomManager.prototype.createRoom = function (config) {
    // ÏÇ¨Ïö© Í∞ÄÎä•Ìïú Î∞© Î≤àÌò∏ Ï∞æÍ∏∞ (1~8)
    var roomId = "1";
    for (var i = 1; i <= 8; i++) {
      var id = i.toString();
      if (!this.gameRooms.has(id)) {
        roomId = id;
        break;
      }
    }
    // Î™®Îì† Î∞©Ïù¥ ÏÇ¨Ïö© Ï§ëÏù∏ Í≤ΩÏö∞
    if (this.gameRooms.size >= 8) {
      throw new Error("Î™®Îì† Í≤åÏûÑÎ∞©Ïù¥ ÏÇ¨Ïö© Ï§ëÏûÖÎãàÎã§.");
    }
    // Í≤åÏûÑÎ∞© ÏÉùÏÑ±
    var room = new GameRoom_1.GameRoom(__assign({
      id: roomId
    }, config));
    // Í≤åÏûÑÎ∞© Îì±Î°ù
    this.gameRooms.set(roomId, room);
    // Ïù¥Î≤§Ìä∏ Î¶¨Ïä§ÎÑà ÏÑ§Ï†ï
    this.setupRoomEventListeners(room);
    // Î∞© ÏÉùÏÑ± Ïù¥Î≤§Ìä∏ Î∞úÏÉù
    this.emit("roomCreated", room);
    return room;
  };
  /**
   * Í≤åÏûÑÎ∞© ÏÇ≠Ï†ú
   */
  GameRoomManager.prototype.removeRoom = function (roomId) {
    var room = this.gameRooms.get(roomId);
    if (!room) {
      return false;
    }
    // Í≤åÏûÑÎ∞© Î¶¨ÏÖã
    room.reset();
    // Í≤åÏûÑÎ∞© ÏÇ≠Ï†ú
    this.gameRooms.delete(roomId);
    // Î∞© ÏÇ≠Ï†ú Ïù¥Î≤§Ìä∏ Î∞úÏÉù
    this.emit("roomRemoved", roomId);
    return true;
  };
  /**
   * Í≤åÏûÑÎ∞© Ï¥àÍ∏∞Ìôî
   */
  GameRoomManager.prototype.resetRoom = function (roomId) {
    var room = this.gameRooms.get(roomId);
    if (!room) {
      return false;
    }
    // Í≤åÏûÑÎ∞© Î¶¨ÏÖã
    room.reset();
    // Î∞© Ï¥àÍ∏∞Ìôî Ïù¥Î≤§Ìä∏ Î∞úÏÉù
    this.emit("roomReset", room);
    return true;
  };
  /**
   * Í≤åÏûÑ Î™®Îìú Îì±Î°ù
   */
  GameRoomManager.prototype.registerGameMode = function (gameMode) {
    this.gameModes.set(gameMode.getId(), gameMode);
  };
  /**
   * Í≤åÏûÑ Î™®Îìú Ï°∞Ìöå
   */
  GameRoomManager.prototype.getGameMode = function (modeId) {
    return this.gameModes.get(modeId);
  };
  /**
   * Î™®Îì† Í≤åÏûÑ Î™®Îìú Ï°∞Ìöå
   */
  GameRoomManager.prototype.getAllGameModes = function () {
    return Array.from(this.gameModes.values());
  };
  /**
   * ÌîåÎ†àÏù¥Ïñ¥Î•º Í≤åÏûÑÎ∞©Ïóê ÏûÖÏû•ÏãúÌÇ¥
   */
  GameRoomManager.prototype.joinRoom = function (roomId, player) {
    var room = this.gameRooms.get(roomId);
    if (!room) {
      return false;
    }
    return room.joinPlayer(player);
  };
  /**
   * ÌîåÎ†àÏù¥Ïñ¥Î•º Í≤åÏûÑÎ∞©ÏóêÏÑú Ìá¥Ïû•ÏãúÌÇ¥
   */
  GameRoomManager.prototype.leaveRoom = function (roomId, playerId) {
    var room = this.gameRooms.get(roomId);
    if (!room) {
      return false;
    }
    return room.leavePlayer(playerId);
  };
  /**
   * Î∞© Ïù¥Î≤§Ìä∏ Î¶¨Ïä§ÎÑà ÏÑ§Ï†ï
   */
  GameRoomManager.prototype.setupRoomEventListeners = function (room) {
    var _this = this;
    // ÌîåÎ†àÏù¥Ïñ¥ ÏûÖÏû• Ïù¥Î≤§Ìä∏
    room.on(GameRoom_1.WaitingRoomEvent.PLAYER_JOIN, function (player) {
      _this.emit("playerJoinedRoom", room, player);
    });
    // ÌîåÎ†àÏù¥Ïñ¥ Ìá¥Ïû• Ïù¥Î≤§Ìä∏
    room.on(GameRoom_1.WaitingRoomEvent.PLAYER_LEAVE, function (player) {
      _this.emit("playerLeftRoom", room, player);
      // Î∞©Ïóê ÌîåÎ†àÏù¥Ïñ¥Í∞Ä ÏóÜÏúºÎ©¥ Î∞© ÏÇ≠Ï†ú
      if (room.getPlayersCount() === 0) {
        _this.removeRoom(room.getId());
      }
    });
    // ÌîåÎ†àÏù¥Ïñ¥ Í∞ïÌá¥ Ïù¥Î≤§Ìä∏
    room.on(GameRoom_1.WaitingRoomEvent.PLAYER_KICK, function (player) {
      _this.emit("playerKicked", room, player);
    });
    // Ìò∏Ïä§Ìä∏ Î≥ÄÍ≤Ω Ïù¥Î≤§Ìä∏
    room.on(GameRoom_1.WaitingRoomEvent.HOST_CHANGE, function (newHost) {
      _this.emit("hostChanged", room, newHost);
    });
    // Ï§ÄÎπÑ ÏÉÅÌÉú Î≥ÄÍ≤Ω Ïù¥Î≤§Ìä∏
    room.on(GameRoom_1.WaitingRoomEvent.READY_STATUS_CHANGE, function (player, isReady) {
      _this.emit("readyStatusChanged", room, player, isReady);
    });
    // Í≤åÏûÑ ÏãúÏûë Ïù¥Î≤§Ìä∏
    room.on(GameRoom_1.WaitingRoomEvent.GAME_START, function () {
      _this.emit("gameStarted", room);
    });
    // Í≤åÏûÑ Ï¢ÖÎ£å Ïù¥Î≤§Ìä∏
    room.on(GameRoom_1.WaitingRoomEvent.GAME_END, function () {
      _this.emit("gameEnded", room);
    });
    // Ï±ÑÌåÖ Î©îÏãúÏßÄ Ïù¥Î≤§Ìä∏
    room.on(GameRoom_1.WaitingRoomEvent.CHAT_MESSAGE, function (player, message) {
      _this.emit("chatMessage", room, player, message);
    });
  };
  /**
   * Ïù¥Î≤§Ìä∏ Î∞úÏÉù
   */
  GameRoomManager.prototype.emit = function (event) {
    var args = [];
    for (var _i = 1; _i < arguments.length; _i++) {
      args[_i - 1] = arguments[_i];
    }
    var callbacks = this.callbacks[event];
    if (!callbacks) return;
    callbacks.forEach(function (callback) {
      try {
        callback.apply(void 0, args);
      } catch (error) {
        console.error("Error in event listener for ".concat(event, ":"), error);
      }
    });
  };
  /**
   * Ïù¥Î≤§Ìä∏ Î¶¨Ïä§ÎÑà Îì±Î°ù
   */
  GameRoomManager.prototype.on = function (event, listener) {
    if (!this.callbacks[event]) {
      this.callbacks[event] = [];
    }
    this.callbacks[event].push(listener);
  };
  /**
   * Ïù¥Î≤§Ìä∏ Î¶¨Ïä§ÎÑà Ï†úÍ±∞
   */
  GameRoomManager.prototype.off = function (event, listener) {
    var callbacks = this.callbacks[event];
    if (!callbacks) return;
    var index = callbacks.indexOf(listener);
    if (index !== -1) {
      callbacks.splice(index, 1);
    }
  };
  return GameRoomManager;
}();
exports.GameRoomManager = GameRoomManager;

/***/ }),

/***/ 668:
/***/ ((__unused_webpack_module, exports) => {



Object.defineProperty(exports, "__esModule", ({
  value: true
}));
exports.GameMode = void 0;
/**
 * Í≤åÏûÑ Î™®Îìú ÌÅ¥ÎûòÏä§
 * ÎßàÌîºÏïÑ Í≤åÏûÑÏùò Î™®ÎìúÎ•º Ï†ïÏùòÌï©ÎãàÎã§. (ÌÅ¥ÎûòÏãù, ÌôïÏû•, Ïª§Ïä§ÌÖÄ Îì±)
 */
var GameMode = /** @class */function () {
  function GameMode(config) {
    this.jobs = [];
    this.id = config.id;
    this.name = config.name;
    this.description = config.description;
    this.jobIds = config.jobIds;
    this.minPlayers = config.minPlayers;
    this.maxPlayers = config.maxPlayers;
  }
  /**
   * Í≤åÏûÑ Î™®Îìú ID Î∞òÌôò
   */
  GameMode.prototype.getId = function () {
    return this.id;
  };
  /**
   * Í≤åÏûÑ Î™®Îìú Ïù¥Î¶Ñ Î∞òÌôò
   */
  GameMode.prototype.getName = function () {
    return this.name;
  };
  /**
   * Í≤åÏûÑ Î™®Îìú ÏÑ§Î™Ö Î∞òÌôò
   */
  GameMode.prototype.getDescription = function () {
    return this.description;
  };
  /**
   * ÏµúÏÜå Ïù∏Ïõê Î∞òÌôò
   */
  GameMode.prototype.getMinPlayers = function () {
    return this.minPlayers;
  };
  /**
   * ÏµúÎåÄ Ïù∏Ïõê Î∞òÌôò
   */
  GameMode.prototype.getMaxPlayers = function () {
    return this.maxPlayers;
  };
  /**
   * ÏßÅÏóÖ Î™©Î°ù ÏÑ§Ï†ï
   */
  GameMode.prototype.setJobs = function (jobs) {
    this.jobs = jobs;
  };
  /**
   * ÏßÅÏóÖ Î™©Î°ù Î∞òÌôò
   */
  GameMode.prototype.getJobs = function () {
    return this.jobs;
  };
  /**
   * JSON Î≥ÄÌôò
   */
  GameMode.prototype.toJSON = function () {
    return {
      id: this.id,
      name: this.name,
      description: this.description,
      minPlayers: this.minPlayers,
      maxPlayers: this.maxPlayers,
      jobIds: this.jobIds
    };
  };
  return GameMode;
}();
exports.GameMode = GameMode;

/***/ }),

/***/ 669:
/***/ ((__unused_webpack_module, exports) => {



// ÎßàÌîºÏïÑ Í≤åÏûÑÏùò ÏßÅÏóÖ ÌÉÄÏûÖÍ≥º Îç∞Ïù¥ÌÑ∞Î•º Ï†ïÏùòÌï©ÎãàÎã§.
Object.defineProperty(exports, "__esModule", ({
  value: true
}));
exports.GAME_MODES = exports.JOBS = exports.JobAbilityType = exports.JobTeam = exports.JobId = void 0;
exports.getJobById = getJobById;
exports.getGameModeById = getGameModeById;
exports.getJobsByGameMode = getJobsByGameMode;
// ÏßÅÏóÖ ID enum
var JobId;
(function (JobId) {
  JobId["MAFIA"] = "mafia";
  JobId["POLICE"] = "police";
  JobId["DOCTOR"] = "doctor";
  JobId["CITIZEN"] = "citizen";
  JobId["SPY"] = "spy";
  JobId["MEDIUM"] = "medium";
  JobId["SOLDIER"] = "soldier";
  JobId["POLITICIAN"] = "politician";
  JobId["LOVER"] = "lover";
  JobId["JOURNALIST"] = "journalist";
  JobId["WEREWOLF"] = "werewolf";
  JobId["GANGSTER"] = "gangster";
  JobId["DETECTIVE"] = "detective";
  JobId["GRAVEDIGGER"] = "gravedigger";
  JobId["TERRORIST"] = "terrorist";
  JobId["MADAM"] = "madam";
})(JobId || (exports.JobId = JobId = {}));
// ÏßÅÏóÖ ÏÜåÏÜç ÌåÄ ÌÉÄÏûÖ
var JobTeam;
(function (JobTeam) {
  JobTeam["MAFIA"] = "\uB9C8\uD53C\uC544\uD300";
  JobTeam["CITIZEN"] = "\uC2DC\uBBFC\uD300";
  JobTeam["NEUTRAL"] = "\uC911\uB9BD";
})(JobTeam || (exports.JobTeam = JobTeam = {}));
// ÏßÅÏóÖ Îä•Î†• ÌÉÄÏûÖ
var JobAbilityType;
(function (JobAbilityType) {
  JobAbilityType["KILL"] = "\uCC98\uD615";
  JobAbilityType["INVESTIGATE"] = "\uC218\uC0C9";
  JobAbilityType["PROTECT"] = "\uCE58\uB8CC";
  JobAbilityType["CONTACT"] = "\uC811\uC120";
  JobAbilityType["LISTEN"] = "\uB3C4\uCCAD";
  JobAbilityType["ARMOR"] = "\uBC29\uD0C4";
  JobAbilityType["IMMUNITY"] = "\uCC98\uC138";
  JobAbilityType["CHAT"] = "\uC5F0\uC560";
  JobAbilityType["ANNOUNCE"] = "\uD2B9\uC885";
  JobAbilityType["CONVERT"] = "\uAC08\uB9DD";
  JobAbilityType["BLOCK"] = "\uACF5\uAC08";
  JobAbilityType["TRACK"] = "\uCD94\uB9AC";
  JobAbilityType["COPY"] = "\uB3C4\uAD74";
  JobAbilityType["SUICIDE"] = "\uC0B0\uD654"; // ÏûêÌè≠
})(JobAbilityType || (exports.JobAbilityType = JobAbilityType = {}));
// ÏßÅÏóÖ Îç∞Ïù¥ÌÑ∞
exports.JOBS = [{
  id: JobId.MAFIA,
  name: "ÎßàÌîºÏïÑ",
  team: JobTeam.MAFIA,
  description: "Î∞§Ïóê ÏãúÎØºÏùÑ Ï†úÍ±∞ÌïòÎäî ÎßàÌîºÏïÑÏûÖÎãàÎã§.",
  abilityType: JobAbilityType.KILL,
  abilityDescription: "Î∞§ÎßàÎã§ ÌïúÎ™ÖÏùò ÌîåÎ†àÏù¥Ïñ¥Î•º Ï£ΩÏùº Ïàò ÏûàÎã§.",
  icon: "üî™",
  nightAbility: true,
  dayAbility: false,
  targetType: "player"
}, {
  id: JobId.POLICE,
  name: "Í≤ΩÏ∞∞",
  team: JobTeam.CITIZEN,
  description: "ÌîåÎ†àÏù¥Ïñ¥Ïùò ÎßàÌîºÏïÑ Ïó¨Î∂ÄÎ•º Ï°∞ÏÇ¨Ìï©ÎãàÎã§.",
  abilityType: JobAbilityType.INVESTIGATE,
  abilityDescription: "Î∞§Ïù¥ÎêòÎ©¥ ÌîåÎ†àÏù¥Ïñ¥ Ìïú Î™ÖÏùÑ ÏÑ†ÌÉùÌï¥ ÎßàÌîºÏïÑ Ïó¨Î∂ÄÎ•º ÏïåÏïÑÎÇº Ïàò ÏûàÎã§.",
  icon: "üîç",
  nightAbility: true,
  dayAbility: false,
  targetType: "player"
}, {
  id: JobId.DOCTOR,
  name: "ÏùòÏÇ¨",
  team: JobTeam.CITIZEN,
  description: "ÌîåÎ†àÏù¥Ïñ¥Î•º ÎßàÌîºÏïÑÏùò Í≥µÍ≤©ÏúºÎ°úÎ∂ÄÌÑ∞ Î≥¥Ìò∏Ìï©ÎãàÎã§.",
  abilityType: JobAbilityType.PROTECT,
  abilityDescription: "Î∞§Ïù¥ÎêòÎ©¥ ÌîåÎ†àÏù¥Ïñ¥ Ìïú Î™ÖÏùÑ ÎßàÌîºÏïÑÏùò Í≥µÍ≤©ÏúºÎ°úÎ∂ÄÌÑ∞ ÏπòÎ£åÌïúÎã§.",
  icon: "üíâ",
  nightAbility: true,
  dayAbility: false,
  targetType: "player"
}, {
  id: JobId.SPY,
  name: "Ïä§ÌååÏù¥",
  team: JobTeam.MAFIA,
  description: "ÎßàÌîºÏïÑ ÌåÄÏùò Ï†ïÎ≥¥ÏõêÏûÖÎãàÎã§.",
  abilityType: JobAbilityType.CONTACT,
  abilityDescription: "Ï†ëÏÑ† Ï†Ñ Î∞§ÎßàÎã§ ÌîåÎ†àÏù¥Ïñ¥ Ìïú Î™ÖÏùÑ Í≥®Îùº, ÎßàÌîºÏïÑÏù∏ÏßÄ ÌôïÏù∏ Ìï† Ïàò ÏûàÎã§.",
  icon: "üïµÔ∏è",
  nightAbility: true,
  dayAbility: false,
  targetType: "player"
}, {
  id: JobId.MEDIUM,
  name: "ÏòÅÎß§",
  team: JobTeam.CITIZEN,
  description: "Ï£ΩÏùÄ ÌîåÎ†àÏù¥Ïñ¥Îì§Ïùò ÎåÄÌôîÎ•º Îì§ÏùÑ Ïàò ÏûàÏäµÎãàÎã§.",
  abilityType: JobAbilityType.LISTEN,
  abilityDescription: "Ï£ΩÏùÄ ÏûêÎì§Ïùò ÎåÄÌôîÎ•º Îì§ÏùÑ Ïàò ÏûàÎã§.",
  icon: "üëª",
  nightAbility: true,
  dayAbility: true,
  targetType: "none"
}, {
  id: JobId.SOLDIER,
  name: "Íµ∞Ïù∏",
  team: JobTeam.CITIZEN,
  description: "ÎßàÌîºÏïÑÏùò Í≥µÍ≤©ÏùÑ Ìïú Î≤à Î∞©Ïñ¥Ìï† Ïàò ÏûàÏäµÎãàÎã§.",
  abilityType: JobAbilityType.ARMOR,
  abilityDescription: "ÎßàÌîºÏïÑÏùò Í≥µÍ≤©ÏùÑ Ìïú Ï∞®Î°Ä Î≤ÑÌÖ®ÎÇº Ïàò ÏûàÎã§.",
  icon: "ü™ñ",
  nightAbility: false,
  dayAbility: false,
  targetType: "none",
  usesPerGame: 1
}, {
  id: JobId.POLITICIAN,
  name: "Ï†ïÏπòÏù∏",
  team: JobTeam.CITIZEN,
  description: "Ìà¨ÌëúÎ°ú Ï≤òÌòïÎêòÏßÄ ÏïäÏäµÎãàÎã§.",
  abilityType: JobAbilityType.IMMUNITY,
  abilityDescription: "ÌîåÎ†àÏù¥Ïñ¥ Í∞Ñ Ìà¨ÌëúÎ•º ÌÜµÌï¥ Ï≤òÌòïÎãπÌïòÏßÄ ÏïäÎäîÎã§.",
  icon: "üó£Ô∏è",
  nightAbility: false,
  dayAbility: false,
  targetType: "none"
}, {
  id: JobId.LOVER,
  name: "Ïó∞Ïù∏",
  team: JobTeam.CITIZEN,
  description: "Î∞§Ïóê Îã§Î•∏ Ïó∞Ïù∏Í≥º ÎåÄÌôîÌï† Ïàò ÏûàÏäµÎãàÎã§.",
  abilityType: JobAbilityType.CHAT,
  abilityDescription: "Î∞§Îßå ÎêòÎ©¥ ÎëòÎßåÏùò ÎåÄÌôîÍ∞Ä Í∞ÄÎä•ÌïòÎã§.",
  icon: "‚ù§Ô∏è",
  nightAbility: true,
  dayAbility: false,
  targetType: "none"
}, {
  id: JobId.JOURNALIST,
  name: "Í∏∞Ïûê",
  team: JobTeam.CITIZEN,
  description: "ÌîåÎ†àÏù¥Ïñ¥Ïùò ÏßÅÏóÖÏùÑ Ï°∞ÏÇ¨ÌïòÏó¨ Í≥µÍ∞úÌï©ÎãàÎã§.",
  abilityType: JobAbilityType.ANNOUNCE,
  abilityDescription: "Î∞§Ïóê Ìïú Î™ÖÏùò ÌîåÎ†àÏù¥Ïñ¥Ïùò ÏßÅÏóÖÏùÑ Ï°∞ÏÇ¨ÌïòÏó¨ Îã§Ïùå ÎÇ† ÏïÑÏπ® Î™®Îì† ÌîåÎ†àÏù¥Ïñ¥ÏóêÍ≤å Ìï¥Îãπ ÏÇ¨Ïã§ÏùÑ ÏïåÎ¶∞Îã§.",
  icon: "üì∞",
  nightAbility: true,
  dayAbility: false,
  targetType: "player"
}, {
  id: JobId.WEREWOLF,
  name: "ÏßêÏäπÏù∏Í∞Ñ",
  team: JobTeam.MAFIA,
  description: "ÎßàÌîºÏïÑÍ∞Ä Î™®Îëê ÏÇ¨ÎßùÌïòÎ©¥ Îä•Î†•Ïù¥ ÌôúÏÑ±ÌôîÎê©ÎãàÎã§.",
  abilityType: JobAbilityType.CONVERT,
  abilityDescription: "Î∞§Ïóê ÏÑ†ÌÉùÌïú ÌîåÎ†àÏù¥Ïñ¥Í∞Ä ÎßàÌîºÏïÑÏóêÍ≤å ÏÇ¥Ìï¥ÎãπÌï† Í≤ΩÏö∞ ÎßàÌîºÏïÑÏóêÍ≤å Í∏∏Îì§Ïó¨ÏßÄÎ©∞, Ïù¥ÌõÑ ÎßàÌîºÏïÑÍ∞Ä Î™®Îëê ÏÇ¨ÎßùÌïòÎ©¥ Î∞§ÎßàÎã§ ÌîåÎ†àÏù¥Ïñ¥Î•º Ï†úÍ±∞Ìï† Ïàò ÏûàÎã§.",
  icon: "üê∫",
  nightAbility: true,
  dayAbility: false,
  targetType: "player"
}, {
  id: JobId.GANGSTER,
  name: "Í±¥Îã¨",
  team: JobTeam.CITIZEN,
  description: "ÌîåÎ†àÏù¥Ïñ¥Ïùò Ìà¨ÌëúÎ•º Î∞©Ìï¥Ìï©ÎãàÎã§.",
  abilityType: JobAbilityType.BLOCK,
  abilityDescription: "Î∞§ÎßàÎã§ Ìïú Î™ÖÏùÑ ÏÑ†ÌÉùÌïòÏó¨, Îã§ÏùåÎÇ† Ìà¨ÌëúÏãú Ìï¥Îãπ ÌîåÎ†àÏù¥Ïñ¥Í∞Ä Ìà¨ÌëúÎ•º ÌïòÏßÄ Î™ªÌïòÎèÑÎ°ù ÎßåÎì†Îã§.",
  icon: "üëä",
  nightAbility: true,
  dayAbility: false,
  targetType: "player"
}, {
  id: JobId.DETECTIVE,
  name: "ÏÇ¨Î¶ΩÌÉêÏ†ï",
  team: JobTeam.CITIZEN,
  description: "ÌîåÎ†àÏù¥Ïñ¥Ïùò Îä•Î†• ÏÇ¨Ïö©ÏùÑ Ï∂îÏ†ÅÌï©ÎãàÎã§.",
  abilityType: JobAbilityType.TRACK,
  abilityDescription: "Î∞§ÎßàÎã§ ÌîåÎ†àÏù¥Ïñ¥ Ìïú Î™ÖÏùÑ Ï°∞ÏÇ¨ÌïòÏó¨ Ìï¥Îãπ ÌîåÎ†àÏù¥Ïñ¥Í∞Ä ÎàÑÍµ¨ÏóêÍ≤å Îä•Î†•ÏùÑ ÏÇ¨Ïö©ÌïòÏòÄÎäîÏßÄ ÏïåÏïÑÎÇº Ïàò ÏûàÎã§.",
  icon: "üïµÔ∏è‚Äç‚ôÇÔ∏è",
  nightAbility: true,
  dayAbility: false,
  targetType: "player"
}, {
  id: JobId.GRAVEDIGGER,
  name: "ÎèÑÍµ¥Íæº",
  team: JobTeam.CITIZEN,
  description: "Ï≤´ÎÇ† ÎßàÌîºÏïÑÏóêÍ≤å ÏÇ¥Ìï¥ÎãπÌïú ÌîåÎ†àÏù¥Ïñ¥Ïùò ÏßÅÏóÖÏùÑ ÏñªÏäµÎãàÎã§.",
  abilityType: JobAbilityType.COPY,
  abilityDescription: "Ï≤´ÎÇ† ÎßàÌîºÏïÑÏóêÍ≤å ÏÇ¥Ìï¥ÎãπÌïú ÌîåÎ†àÏù¥Ïñ¥Ïùò ÏßÅÏóÖÏùÑ ÏñªÎäîÎã§.",
  icon: "‚ö∞Ô∏è",
  nightAbility: false,
  dayAbility: false,
  targetType: "none"
}, {
  id: JobId.TERRORIST,
  name: "ÌÖåÎü¨Î¶¨Ïä§Ìä∏",
  team: JobTeam.CITIZEN,
  description: "Ï≤òÌòïÎê† Îïå Îã§Î•∏ ÌîåÎ†àÏù¥Ïñ¥Î•º Ìï®Íªò Ï≤òÌòïÌï©ÎãàÎã§.",
  abilityType: JobAbilityType.SUICIDE,
  abilityDescription: "Ìà¨ÌëúÎ°ú Ïù∏Ìï¥ Ï≤òÌòïÎê† Îïå, ÌîåÎ†àÏù¥Ïñ¥ Ìïú Î™ÖÏùÑ ÏÑ†ÌÉùÌïòÏó¨ Í∞ôÏù¥ Ï≤òÌòïÎê† Ïàò ÏûàÎã§.",
  icon: "üí£",
  nightAbility: false,
  dayAbility: false,
  targetType: "player",
  usesPerGame: 1
}, {
  id: JobId.MADAM,
  name: "ÎßàÎã¥",
  team: JobTeam.MAFIA,
  description: "ÎßàÌîºÏïÑÏôÄ Ï†ëÏ¥âÌïòÏó¨ ÎåÄÌôîÌï† Ïàò ÏûàÏäµÎãàÎã§.",
  abilityType: JobAbilityType.CONTACT,
  abilityDescription: "ÎßàÌîºÏïÑÎ•º Ïú†ÌòπÌï† Í≤ΩÏö∞, ÏÑúÎ°úÏùò Ï°¥Ïû¨Î•º ÏïåÏïÑÏ∞®Î¶¨Í≥† Î∞§Ïóê ÎåÄÌôîÌï† Ïàò ÏûàÍ≤å ÎêúÎã§.",
  icon: "üíã",
  nightAbility: true,
  dayAbility: false,
  targetType: "player"
}, {
  id: JobId.CITIZEN,
  name: "ÏãúÎØº",
  team: JobTeam.CITIZEN,
  description: "ÌäπÎ≥ÑÌïú Îä•Î†•Ïù¥ ÏóÜÎäî ÏùºÎ∞ò ÏãúÎØºÏûÖÎãàÎã§.",
  abilityType: JobAbilityType.INVESTIGATE,
  abilityDescription: "ÌäπÎ≥ÑÌïú Îä•Î†•Ïù¥ ÏóÜÏäµÎãàÎã§.",
  icon: "üë§",
  nightAbility: false,
  dayAbility: false,
  targetType: "none"
}];
// Í≤åÏûÑ Î™®Îìú Îç∞Ïù¥ÌÑ∞
exports.GAME_MODES = [{
  id: "classic",
  name: "ÌÅ¥ÎûòÏãù Î™®Îìú",
  description: "Í∏∞Î≥∏Ï†ÅÏù∏ ÎßàÌîºÏïÑ Í≤åÏûÑ Î™®ÎìúÏûÖÎãàÎã§.",
  jobIds: [JobId.MAFIA, JobId.POLICE, JobId.DOCTOR, JobId.CITIZEN],
  minPlayers: 4,
  maxPlayers: 8
}, {
  id: "extended",
  name: "ÌôïÏû• Î™®Îìú",
  description: "Îã§ÏñëÌïú ÏßÅÏóÖÏù¥ Ï∂îÍ∞ÄÎêú ÌôïÏû• Î™®ÎìúÏûÖÎãàÎã§.",
  jobIds: [JobId.MAFIA, JobId.POLICE, JobId.DOCTOR, JobId.SPY, JobId.MEDIUM, JobId.SOLDIER, JobId.POLITICIAN, JobId.JOURNALIST],
  minPlayers: 6,
  maxPlayers: 12
}, {
  id: "chaos",
  name: "Ïπ¥Ïò§Ïä§ Î™®Îìú",
  description: "Î™®Îì† ÏßÅÏóÖÏù¥ Îì±Ïû•ÌïòÎäî ÌòºÎèàÏùò Î™®ÎìúÏûÖÎãàÎã§.",
  jobIds: [JobId.MAFIA, JobId.POLICE, JobId.DOCTOR, JobId.SPY, JobId.MEDIUM, JobId.SOLDIER, JobId.POLITICIAN, JobId.LOVER, JobId.JOURNALIST, JobId.WEREWOLF, JobId.GANGSTER, JobId.DETECTIVE, JobId.GRAVEDIGGER, JobId.TERRORIST, JobId.MADAM],
  minPlayers: 8,
  maxPlayers: 15
}];
// ÏßÅÏóÖ IDÎ°ú ÏßÅÏóÖ Ï†ïÎ≥¥ Í∞ÄÏ†∏Ïò§Í∏∞
function getJobById(jobId) {
  return exports.JOBS.find(function (job) {
    return job.id === jobId;
  });
}
// Í≤åÏûÑ Î™®Îìú IDÎ°ú Í≤åÏûÑ Î™®Îìú Ï†ïÎ≥¥ Í∞ÄÏ†∏Ïò§Í∏∞
function getGameModeById(modeId) {
  return exports.GAME_MODES.find(function (mode) {
    return mode.id === modeId;
  });
}
// Í≤åÏûÑ Î™®ÎìúÏóê Îî∞Î•∏ ÏßÅÏóÖ Î™©Î°ù Í∞ÄÏ†∏Ïò§Í∏∞
function getJobsByGameMode(modeId) {
  var gameMode = getGameModeById(modeId);
  if (!gameMode) return [];
  return gameMode.jobIds.map(function (jobId) {
    var job = getJobById(jobId);
    return job ? job : null;
  }).filter(function (job) {
    return job !== null;
  });
}

/***/ }),

/***/ 727:
/***/ ((__unused_webpack_module, exports, __webpack_require__) => {



Object.defineProperty(exports, "__esModule", ({
  value: true
}));
exports.GameRoom = exports.WaitingRoomEvent = exports.GameRoomState = void 0;
var GameFlowManager_1 = __webpack_require__(206);
var Common_1 = __webpack_require__(169);
var JobTypes_1 = __webpack_require__(669);
// GameRoomState Ïó¥Í±∞Ìòï
var GameRoomState;
(function (GameRoomState) {
  /** ÎåÄÍ∏∞ Ï§ë */
  GameRoomState["WAITING"] = "waiting";
  /** Í≤åÏûÑ ÏßÑÌñâ Ï§ë */
  GameRoomState["PLAYING"] = "playing";
  /** Í≤åÏûÑ Ï¢ÖÎ£å */
  GameRoomState["ENDED"] = "ended";
})(GameRoomState || (exports.GameRoomState = GameRoomState = {}));
// WaitingRoomEvent Ïó¥Í±∞Ìòï
var WaitingRoomEvent;
(function (WaitingRoomEvent) {
  /** ÌîåÎ†àÏù¥Ïñ¥ ÏûÖÏû• */
  WaitingRoomEvent["PLAYER_JOIN"] = "playerJoin";
  /** ÌîåÎ†àÏù¥Ïñ¥ Ìá¥Ïû• */
  WaitingRoomEvent["PLAYER_LEAVE"] = "playerLeave";
  /** ÌîåÎ†àÏù¥Ïñ¥ Í∞ïÌá¥ */
  WaitingRoomEvent["PLAYER_KICK"] = "playerKick";
  /** Ìò∏Ïä§Ìä∏ Î≥ÄÍ≤Ω */
  WaitingRoomEvent["HOST_CHANGE"] = "hostChange";
  /** Ï§ÄÎπÑ ÏÉÅÌÉú Î≥ÄÍ≤Ω */
  WaitingRoomEvent["READY_STATUS_CHANGE"] = "readyStatusChange";
  /** Í≤åÏûÑ ÏãúÏûë */
  WaitingRoomEvent["GAME_START"] = "gameStart";
  /** Í≤åÏûÑ Ï¢ÖÎ£å */
  WaitingRoomEvent["GAME_END"] = "gameEnd";
  /** Ï±ÑÌåÖ Î©îÏãúÏßÄ */
  WaitingRoomEvent["CHAT_MESSAGE"] = "chatMessage";
})(WaitingRoomEvent || (exports.WaitingRoomEvent = WaitingRoomEvent = {}));
// Define constants based on your code (placeholder values assumed)
var STATE_INIT = "INIT";
var GAMEROOM_LOCATIONS = {
  1: Map.getLocation("GameRoom_1") ? Map.getLocationList("GameRoom_1")[0] : null,
  2: Map.getLocation("GameRoom_2") ? Map.getLocationList("GameRoom_2")[0] : null,
  3: Map.getLocation("GameRoom_3") ? Map.getLocationList("GameRoom_3")[0] : null,
  4: Map.getLocation("GameRoom_4") ? Map.getLocationList("GameRoom_4")[0] : null,
  5: Map.getLocation("GameRoom_5") ? Map.getLocationList("GameRoom_5")[0] : null,
  6: Map.getLocation("GameRoom_6") ? Map.getLocationList("GameRoom_6")[0] : null,
  7: Map.getLocation("GameRoom_7") ? Map.getLocationList("GameRoom_7")[0] : null,
  8: Map.getLocation("GameRoom_8") ? Map.getLocationList("GameRoom_8")[0] : null
};
var START_WAIT_TIME = 30;
var GameRoom = /** @class */function () {
  function GameRoom(config) {
    this.host = null;
    this.players = [];
    this.readyPlayers = new Set();
    this.state = GameRoomState.WAITING;
    /**
     * Ïù¥Î≤§Ìä∏ Ï≤òÎ¶¨Î•º ÏúÑÌïú ÏΩúÎ∞± Ìï®Ïàò Îì±Î°ù
     */
    this.callbacks = {};
    this.id = config.id;
    this.title = config.title;
    this.gameMode = config.gameMode;
    this.maxPlayers = config.maxPlayers;
    this.password = config.password;
    this.createdAt = Date.now();
    // Í∏∞Ï°¥ ÏΩîÎìúÏôÄ Ìò∏ÌôòÎêòÎèÑÎ°ù ÏàòÏ†ï
    this.flowManager = new GameFlowManager_1.GameFlowManager(parseInt(this.id));
    this.flowManager.setGameRoom(this);
  }
  /**
   * Í≤åÏûÑ ÌîåÎ†àÏù¥Ïñ¥ Ï°∞Ìöå (GameFlowManager Ìò∏ÌôòÏö©)
   */
  GameRoom.prototype.getGamePlayer = function (playerId) {
    return (0, Common_1.getPlayerById)(playerId);
  };
  /**
   * Î∞© ÌîåÎ†àÏù¥Ïñ¥Îì§ÏóêÍ≤å Ïï°ÏÖò Ï†ÑÏÜ° (GameFlowManager Ìò∏ÌôòÏö©)
   */
  GameRoom.prototype.actionToRoomPlayers = function (action, data) {
    if (typeof action === 'function') {
      // ÏΩúÎ∞± Ìï®ÏàòÎ°ú Ï≤òÎ¶¨
      this.players.forEach(function (player) {
        action(player);
      });
    } else {
      // Î¨∏ÏûêÏó¥ Ïï°ÏÖòÏúºÎ°ú Ï≤òÎ¶¨
      this.players.forEach(function (player) {
        var gamePlayer = (0, Common_1.getPlayerById)(player.id);
        if (gamePlayer) {
          gamePlayer.tag[action] = data;
          gamePlayer.sendUpdated();
        }
      });
    }
  };
  /**
   * ÌäπÏ†ï ÌîåÎ†àÏù¥Ïñ¥ Ï°∞Ìöå (GameFlowManager Ìò∏ÌôòÏö©)
   */
  GameRoom.prototype.getPlayer = function (playerId) {
    return this.players.find(function (p) {
      return p.id === playerId;
    });
  };
  GameRoom.prototype.getId = function () {
    return this.id;
  };
  GameRoom.prototype.getTitle = function () {
    return this.title;
  };
  GameRoom.prototype.getGameMode = function () {
    return this.gameMode;
  };
  GameRoom.prototype.getMaxPlayers = function () {
    return this.maxPlayers;
  };
  GameRoom.prototype.getPlayers = function () {
    return this.players;
  };
  GameRoom.prototype.getPlayersCount = function () {
    return this.players.length;
  };
  GameRoom.prototype.isFull = function () {
    return this.players.length >= this.maxPlayers;
  };
  GameRoom.prototype.getState = function () {
    return this.state;
  };
  GameRoom.prototype.getHost = function () {
    return this.host;
  };
  GameRoom.prototype.getCreatedAt = function () {
    return this.createdAt;
  };
  GameRoom.prototype.hasPassword = function () {
    return !!this.password;
  };
  GameRoom.prototype.isPasswordCorrect = function (password) {
    return this.password === password;
  };
  GameRoom.prototype.isPlayerReady = function (playerId) {
    return this.readyPlayers.has(playerId);
  };
  GameRoom.prototype.areAllPlayersReady = function () {
    // Ìò∏Ïä§Ìä∏Îäî Ï§ÄÎπÑ ÏÉÅÌÉúÍ∞Ä ÌïÑÏöî ÏóÜÏùå
    if (this.players.length < 4) return false;
    // Î™®Îì† ÌîåÎ†àÏù¥Ïñ¥Í∞Ä Ï§ÄÎπÑ ÏÉÅÌÉúÏù∏ÏßÄ ÌôïÏù∏
    for (var _i = 0, _a = this.players; _i < _a.length; _i++) {
      var player = _a[_i];
      if (this.host && player.id === this.host.id) continue;
      if (!this.readyPlayers.has(player.id)) return false;
    }
    return true;
  };
  /**
   * Ïù¥Î≤§Ìä∏ Î¶¨Ïä§ÎÑà Îì±Î°ù
   */
  GameRoom.prototype.on = function (event, listener) {
    var _a;
    if (!this.callbacks[event]) {
      this.callbacks[event] = [];
    }
    (_a = this.callbacks[event]) === null || _a === void 0 ? void 0 : _a.push(listener);
  };
  /**
   * Ïù¥Î≤§Ìä∏ Î¶¨Ïä§ÎÑà Ï†úÍ±∞
   */
  GameRoom.prototype.off = function (event, listener) {
    var callbacks = this.callbacks[event];
    if (!callbacks) return;
    var index = callbacks.indexOf(listener);
    if (index !== -1) {
      callbacks.splice(index, 1);
    }
  };
  /**
   * Ïù¥Î≤§Ìä∏ Î∞úÏÉù
   */
  GameRoom.prototype.emit = function (event) {
    var args = [];
    for (var _i = 1; _i < arguments.length; _i++) {
      args[_i - 1] = arguments[_i];
    }
    var callbacks = this.callbacks[event];
    if (!callbacks) return;
    callbacks.forEach(function (callback) {
      try {
        callback.apply(void 0, args);
      } catch (error) {
        console.error("Error in event listener for ".concat(event, ":"), error);
      }
    });
  };
  /**
   * Ïú†Ï†Ä ÏûÖÏû•
   */
  GameRoom.prototype.joinPlayer = function (player) {
    // Ïù¥ÎØ∏ Î∞©Ïóê ÏûàÎäî ÌîåÎ†àÏù¥Ïñ¥Ïù∏ÏßÄ ÌôïÏù∏
    if (this.players.some(function (p) {
      return p.id === player.id;
    })) {
      return false;
    }
    // Î∞©Ïù¥ ÍΩâ Ï∞ºÎäîÏßÄ ÌôïÏù∏
    if (this.isFull()) {
      return false;
    }
    // Í≤åÏûÑ Ï§ëÏù∏ÏßÄ ÌôïÏù∏
    if (this.state !== GameRoomState.WAITING) {
      return false;
    }
    // ÌîåÎ†àÏù¥Ïñ¥ Ï∂îÍ∞Ä (Í∏∞Ï°¥ ÏΩîÎìúÏôÄ Ìò∏ÌôòÎêòÎèÑÎ°ù ÏàòÏ†ï)
    var mafiaPlayer = {
      id: player.id,
      name: player.name,
      jobId: JobTypes_1.JobId.CITIZEN,
      // Í∏∞Î≥∏ ÏßÅÏóÖÏùÄ ÏãúÎØº
      isAlive: true,
      emoji: "üë§" // Í∏∞Î≥∏ Ïù¥Î™®ÏßÄ
    };
    this.players.push(mafiaPlayer);
    // ÌîåÎ†àÏù¥Ïñ¥ ÌÉúÍ∑∏Ïóê ÎßàÌîºÏïÑ ÌîåÎ†àÏù¥Ïñ¥ Ï†ïÎ≥¥ Ï†ÄÏû•
    player.tag.mafiaPlayer = mafiaPlayer;
    // ÌîåÎ†àÏù¥Ïñ¥ ÏúÑÏπò ÏÑ§Ï†ï
    var locationInfo = GAMEROOM_LOCATIONS[parseInt(this.id)];
    if (locationInfo) {
      player.spawnAtLocation("GameRoom_".concat(this.id));
      player.setCameraTarget(Math.floor(locationInfo.x + locationInfo.width / 2), Math.floor(locationInfo.y + locationInfo.height / 2), 0);
      player.displayRatio = 1.5;
      player.sendUpdated();
    }
    // Î∞© Ï†ïÎ≥¥ Ï†ÄÏû•
    player.tag.roomInfo = {
      roomNum: parseInt(this.id)
    };
    // Ï≤´ ÌîåÎ†àÏù¥Ïñ¥Ïù∏ Í≤ΩÏö∞ Ìò∏Ïä§Ìä∏Î°ú ÏßÄÏ†ï
    if (!this.host) {
      this.host = player;
    }
    // ÏûÖÏû• Ïù¥Î≤§Ìä∏ Î∞úÏÉù
    this.emit(WaitingRoomEvent.PLAYER_JOIN, player);
    return true;
  };
  /**
   * Ïú†Ï†Ä Ìá¥Ïû•
   */
  GameRoom.prototype.leavePlayer = function (playerId) {
    var playerIndex = this.players.findIndex(function (p) {
      return p.id === playerId;
    });
    if (playerIndex === -1) {
      return false;
    }
    var player = (0, Common_1.getPlayerById)(playerId);
    if (!player) {
      return false;
    }
    // ÌîåÎ†àÏù¥Ïñ¥ Î™©Î°ùÏóêÏÑú Ï†úÍ±∞
    this.players.splice(playerIndex, 1);
    // Ï§ÄÎπÑ ÏÉÅÌÉúÎèÑ ÏÇ≠Ï†ú
    this.readyPlayers.delete(playerId);
    // ÌîåÎ†àÏù¥Ïñ¥ ÌÉúÍ∑∏ Ï†ïÎ≥¥ Ï¥àÍ∏∞Ìôî
    player.tag.roomInfo = null;
    player.tag.mafiaPlayer = null;
    // ÌîåÎ†àÏù¥Ïñ¥ ÏúÑÏπò Ïù¥Îèô
    player.spawnAtLocation("Lobby");
    // ÏúÑÏ†Ø Ï†úÍ±∞
    if (player.tag.widget) {
      if (player.tag.widget.gameStatus) {
        player.tag.widget.gameStatus.destroy();
        player.tag.widget.gameStatus = null;
      }
      if (player.tag.widget.nightAction) {
        player.tag.widget.nightAction.destroy();
        player.tag.widget.nightAction = null;
      }
      if (player.tag.widget.voteWidget) {
        player.tag.widget.voteWidget.destroy();
        player.tag.widget.voteWidget = null;
      }
    }
    // Ìò∏Ïä§Ìä∏Í∞Ä ÎÇòÍ∞Ñ Í≤ΩÏö∞ ÏÉàÎ°úÏö¥ Ìò∏Ïä§Ìä∏ ÏßÄÏ†ï
    if (this.host && this.host.id === playerId) {
      this.assignNewHost();
    }
    // Ìá¥Ïû• Ïù¥Î≤§Ìä∏ Î∞úÏÉù
    this.emit(WaitingRoomEvent.PLAYER_LEAVE, player);
    return true;
  };
  /**
   * Ïú†Ï†Ä Í∞ïÌá¥
   */
  GameRoom.prototype.kickPlayer = function (hostId, targetId) {
    // Ìò∏Ïä§Ìä∏Ïù∏ÏßÄ ÌôïÏù∏
    if (!this.host || this.host.id !== hostId) {
      return false;
    }
    // ÏûêÍ∏∞ ÏûêÏã†ÏùÄ Í∞ïÌá¥Ìï† Ïàò ÏóÜÏùå
    if (hostId === targetId) {
      return false;
    }
    var targetPlayer = (0, Common_1.getPlayerById)(targetId);
    if (!targetPlayer) {
      return false;
    }
    // ÌîåÎ†àÏù¥Ïñ¥ Ìá¥Ïû• Ï≤òÎ¶¨
    var result = this.leavePlayer(targetId);
    if (!result) {
      return false;
    }
    // Í∞ïÌá¥ Ïù¥Î≤§Ìä∏ Î∞úÏÉù
    this.emit(WaitingRoomEvent.PLAYER_KICK, targetPlayer);
    return true;
  };
  /**
   * ÏÉàÎ°úÏö¥ Ìò∏Ïä§Ìä∏ ÏßÄÏ†ï
   */
  GameRoom.prototype.assignNewHost = function () {
    if (this.players.length === 0) {
      this.host = null;
      return;
    }
    // Ï≤´ Î≤àÏß∏ ÌîåÎ†àÏù¥Ïñ¥Î•º Ìò∏Ïä§Ìä∏Î°ú ÏßÄÏ†ï
    var firstPlayerId = this.players[0].id;
    var newHost = (0, Common_1.getPlayerById)(firstPlayerId);
    if (newHost) {
      this.host = newHost;
      // ÏÉà Ìò∏Ïä§Ìä∏ Ïù¥Î≤§Ìä∏ Î∞úÏÉù
      this.emit(WaitingRoomEvent.HOST_CHANGE, newHost);
    }
  };
  /**
   * Ìò∏Ïä§Ìä∏ Î≥ÄÍ≤Ω
   */
  GameRoom.prototype.changeHost = function (hostId, newHostId) {
    // ÌòÑÏû¨ Ìò∏Ïä§Ìä∏Ïù∏ÏßÄ ÌôïÏù∏
    if (!this.host || this.host.id !== hostId) {
      return false;
    }
    var newHost = (0, Common_1.getPlayerById)(newHostId);
    if (!newHost) {
      return false;
    }
    // ÌîåÎ†àÏù¥Ïñ¥Í∞Ä Î∞©Ïóê ÏûàÎäîÏßÄ ÌôïÏù∏
    if (!this.players.some(function (p) {
      return p.id === newHostId;
    })) {
      return false;
    }
    this.host = newHost;
    // ÏÉà Ìò∏Ïä§Ìä∏ Ïù¥Î≤§Ìä∏ Î∞úÏÉù
    this.emit(WaitingRoomEvent.HOST_CHANGE, newHost);
    return true;
  };
  /**
   * Ï§ÄÎπÑ ÏÉÅÌÉú Î≥ÄÍ≤Ω
   */
  GameRoom.prototype.toggleReady = function (playerId) {
    // Ìò∏Ïä§Ìä∏Îäî Ï§ÄÎπÑ ÏÉÅÌÉúÍ∞Ä ÌïÑÏöî ÏóÜÏùå
    if (this.host && this.host.id === playerId) {
      return false;
    }
    // Ï°¥Ïû¨ÌïòÎäî ÌîåÎ†àÏù¥Ïñ¥Ïù∏ÏßÄ ÌôïÏù∏
    if (!this.players.some(function (p) {
      return p.id === playerId;
    })) {
      return false;
    }
    var player = (0, Common_1.getPlayerById)(playerId);
    if (!player) {
      return false;
    }
    // ÌòÑÏû¨ Ï§ÄÎπÑ ÏÉÅÌÉú ÌôïÏù∏ ÌõÑ ÌÜ†Í∏Ä
    var isCurrentlyReady = this.readyPlayers.has(playerId);
    if (isCurrentlyReady) {
      this.readyPlayers.delete(playerId);
    } else {
      this.readyPlayers.add(playerId);
    }
    // Ï§ÄÎπÑ ÏÉÅÌÉú Î≥ÄÍ≤Ω Ïù¥Î≤§Ìä∏ Î∞úÏÉù
    this.emit(WaitingRoomEvent.READY_STATUS_CHANGE, player, !isCurrentlyReady);
    return true;
  };
  /**
   * Í≤åÏûÑ ÏãúÏûë
   */
  GameRoom.prototype.startGame = function (hostId) {
    // Ìò∏Ïä§Ìä∏Ïù∏ÏßÄ ÌôïÏù∏
    if (!this.host || this.host.id !== hostId) {
      return false;
    }
    // ÏµúÏÜå Ïù∏Ïõê ÌôïÏù∏ (ÎßàÌîºÏïÑ Í≤åÏûÑÏùÄ ÏùºÎ∞òÏ†ÅÏúºÎ°ú ÏµúÏÜå 4Î™Ö)
    if (this.players.length < 4) {
      return false;
    }
    // Î™®Îì† ÌîåÎ†àÏù¥Ïñ¥Í∞Ä Ï§ÄÎπÑ ÏÉÅÌÉúÏù∏ÏßÄ ÌôïÏù∏ 
    if (!this.areAllPlayersReady()) {
      return false;
    }
    // Í≤åÏûÑ ÏÉÅÌÉú Î≥ÄÍ≤Ω
    this.state = GameRoomState.PLAYING;
    // Í≤åÏûÑ ÏãúÏûë Ï≤òÎ¶¨
    try {
      this.flowManager.startGame();
    } catch (error) {
      console.error("Error starting game:", error);
      this.state = GameRoomState.WAITING;
      return false;
    }
    // Í≤åÏûÑ ÏãúÏûë Ïù¥Î≤§Ìä∏ Î∞úÏÉù
    this.emit(WaitingRoomEvent.GAME_START);
    return true;
  };
  /**
   * Í≤åÏûÑ Ï¢ÖÎ£å
   */
  GameRoom.prototype.endGame = function () {
    this.state = GameRoomState.WAITING;
    this.readyPlayers.clear();
    // Í≤åÏûÑ Ï¢ÖÎ£å Ïù¥Î≤§Ìä∏ Î∞úÏÉù
    this.emit(WaitingRoomEvent.GAME_END);
  };
  /**
   * Î∞© Ï¥àÍ∏∞Ìôî
   */
  GameRoom.prototype.reset = function () {
    // Î™®Îì† ÌîåÎ†àÏù¥Ïñ¥Ïùò ÏúÑÏ†Ø Ï†úÍ±∞
    this.players.forEach(function (player) {
      var gamePlayer = (0, Common_1.getPlayerById)(player.id);
      if (!gamePlayer) return;
      if (gamePlayer.tag.widget) {
        if (gamePlayer.tag.widget.gameStatus) {
          gamePlayer.tag.widget.gameStatus.destroy();
          gamePlayer.tag.widget.gameStatus = null;
        }
        if (gamePlayer.tag.widget.nightAction) {
          gamePlayer.tag.widget.nightAction.destroy();
          gamePlayer.tag.widget.nightAction = null;
        }
        if (gamePlayer.tag.widget.voteWidget) {
          gamePlayer.tag.widget.voteWidget.destroy();
          gamePlayer.tag.widget.voteWidget = null;
        }
      }
    });
    // ÌîåÎ†àÏù¥Ïñ¥ Î™©Î°ù Ï¥àÍ∏∞Ìôî
    this.players = [];
    this.readyPlayers.clear();
    this.host = null;
    this.state = GameRoomState.WAITING;
    // Í≤åÏûÑ ÌîåÎ°úÏö∞ Îß§ÎãàÏ†Ä Ï¥àÍ∏∞Ìôî
    this.flowManager = new GameFlowManager_1.GameFlowManager(parseInt(this.id));
    this.flowManager.setGameRoom(this);
  };
  /**
   * Î∞© Ï†ïÎ≥¥ JSON Î≥ÄÌôò
   */
  GameRoom.prototype.toJSON = function () {
    var _this = this;
    return {
      id: this.id,
      title: this.title,
      gameMode: this.gameMode.getName(),
      maxPlayers: this.maxPlayers,
      hasPassword: this.hasPassword(),
      playersCount: this.getPlayersCount(),
      host: this.host ? {
        id: this.host.id,
        name: this.host.name
      } : null,
      state: this.state,
      players: this.players.map(function (player) {
        return {
          id: player.id,
          name: player.name,
          isReady: _this.isPlayerReady(player.id),
          isHost: _this.host ? player.id === _this.host.id : false
        };
      }),
      createdAt: new Date(this.createdAt).toISOString()
    };
  };
  return GameRoom;
}();
exports.GameRoom = GameRoom;

/***/ }),

/***/ 764:
/***/ ((__unused_webpack_module, exports, __webpack_require__) => {



Object.defineProperty(exports, "__esModule", ({
  value: true
}));
exports.createDefaultGameModes = createDefaultGameModes;
var GameMode_1 = __webpack_require__(668);
var JobTypes_1 = __webpack_require__(669);
/**
 * Í∏∞Ï°¥ Í≤åÏûÑ Î™®Îìú Ï†ïÎ≥¥Î•º ÏÇ¨Ïö©ÌïòÏó¨ GameMode ÌÅ¥ÎûòÏä§ ÏÉùÏÑ±
 */
function createDefaultGameModes() {
  var modes = [];
  // Í∏∞Ï°¥ JobTypesÏùò Í≤åÏûÑ Î™®Îìú ÏÑ§Ï†ïÏùÑ ÌôúÏö©
  JobTypes_1.GAME_MODES.forEach(function (modeData) {
    var modeConfig = {
      id: modeData.id,
      name: modeData.name,
      description: modeData.description,
      jobIds: modeData.jobIds,
      minPlayers: modeData.minPlayers,
      maxPlayers: modeData.maxPlayers
    };
    var gameMode = new GameMode_1.GameMode(modeConfig);
    // ÏßÅÏóÖ Ï†ïÎ≥¥ ÏÑ§Ï†ï
    var jobs = (0, JobTypes_1.getJobsByGameMode)(modeData.id);
    if (jobs.length > 0) {
      gameMode.setJobs(jobs);
    }
    modes.push(gameMode);
  });
  return modes;
}

/***/ }),

/***/ 771:
/***/ ((__unused_webpack_module, exports) => {



Object.defineProperty(exports, "__esModule", ({
  value: true
}));
exports.GameBase = void 0;
var GameBase = /** @class */function () {
  function GameBase() {
    this.onStartCallbacks = [];
    this.onDestroyCallbacks = [];
    this.onJoinPlayerCallbacks = [];
    this.onLeavePlayerCallbacks = [];
    this.onUpdateCallbacks = [];
    this.onTriggerObjectCallbacks = [];
    this.initEventListeners();
  }
  GameBase.prototype.initEventListeners = function () {
    var _this = this;
    App.onStart.Add(function () {
      _this.onStartCallbacks.forEach(function (callback) {
        try {
          callback();
        } catch (error) {
          //*
        }
      });
    });
    App.onJoinPlayer.Add(function (player) {
      _this.onJoinPlayerCallbacks.forEach(function (callback) {
        try {
          callback(player);
        } catch (error) {
          //*
        }
      });
    });
    App.onLeavePlayer.Add(function (player) {
      _this.onLeavePlayerCallbacks.forEach(function (callback) {
        try {
          callback(player);
        } catch (error) {
          //*
        }
      });
    });
    App.onUpdate.Add(function (dt) {
      _this.onUpdateCallbacks.forEach(function (callback) {
        try {
          callback(dt);
        } catch (error) {
          //*
        }
      });
    });
    App.onDestroy.Add(function () {
      _this.onDestroyCallbacks.forEach(function (callback) {
        try {
          callback();
        } catch (error) {
          //*
        }
      });
    });
    App.onTriggerObject.Add(function (sender, layerId, x, y, key) {
      _this.onTriggerObjectCallbacks.forEach(function (callback) {
        try {
          callback(sender, layerId, x, y, key);
        } catch (error) {
          //*
        }
      });
    });
  };
  GameBase.prototype.addOnStartCallback = function (callback) {
    this.onStartCallbacks.push(callback);
  };
  GameBase.prototype.addOnDestroyCallback = function (callback) {
    this.onDestroyCallbacks.push(callback);
  };
  GameBase.prototype.addOnJoinPlayerCallback = function (callback) {
    this.onJoinPlayerCallbacks.push(callback);
  };
  GameBase.prototype.addOnLeavePlayerCallback = function (callback) {
    this.onLeavePlayerCallbacks.push(callback);
  };
  GameBase.prototype.addOnUpdateCallback = function (callback) {
    this.onUpdateCallbacks.push(callback);
  };
  GameBase.prototype.addOnTriggerObjectCallback = function (callback) {
    this.onTriggerObjectCallbacks.push(callback);
  };
  return GameBase;
}();
exports.GameBase = GameBase;

/***/ }),

/***/ 773:
/***/ ((__unused_webpack_module, exports) => {



Object.defineProperty(exports, "__esModule", ({
  value: true
}));
exports.Localizer = void 0;
var LOCALIZE_KEYS = {};
var LOCALIZE_CONTAINER = {
  ko: null,
  ja: null,
  en: null
};
var Localizer = /** @class */function () {
  function Localizer() {}
  Localizer.getLanguageCode = function (player) {
    return player.language === "ko" || player.language === "ja" ? player.language : "en";
  };
  Localizer.prepareLocalizationContainer = function (player) {
    var language = this.getLanguageCode(player);
    if (LOCALIZE_CONTAINER[language] === null) {
      LOCALIZE_CONTAINER[language] = Object.keys(LOCALIZE_KEYS).reduce(this.localizeKey.bind(null, player), {});
    }
  };
  Localizer.getLocalizeString = function (player, key) {
    var _a;
    var language = this.getLanguageCode(player);
    return (_a = LOCALIZE_CONTAINER[language][key]) !== null && _a !== void 0 ? _a : "";
  };
  Localizer.getLocalizeContainer = function (player) {
    var language = this.getLanguageCode(player);
    return LOCALIZE_CONTAINER[language];
  };
  Localizer.localizeKey = function (player, acc, key) {
    acc[key] = player.localize(key);
    return acc;
  };
  return Localizer;
}();
exports.Localizer = Localizer;

/***/ })

/******/ 	});
/************************************************************************/
/******/ 	// The module cache
/******/ 	var __webpack_module_cache__ = {};
/******/ 	
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/ 		// Check if module is in cache
/******/ 		var cachedModule = __webpack_module_cache__[moduleId];
/******/ 		if (cachedModule !== undefined) {
/******/ 			return cachedModule.exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = __webpack_module_cache__[moduleId] = {
/******/ 			// no module.id needed
/******/ 			// no module.loaded needed
/******/ 			exports: {}
/******/ 		};
/******/ 	
/******/ 		// Execute the module function
/******/ 		__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/ 	
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/ 	
/************************************************************************/
var __webpack_exports__ = {};
// This entry needs to be wrapped in an IIFE because it uses a non-standard name for the exports (exports).
(() => {
var exports = __webpack_exports__;
var __webpack_unused_export__;


__webpack_unused_export__ = ({
  value: true
});
var Game_1 = __webpack_require__(401);
App.onInit.Add(function () {
  App.cameraEffect = 1; // 1 = ÎπÑÎÑ§ÌåÖ Ìö®Í≥º
  App.cameraEffectParam1 = 2000;
  App.sendUpdated();
  Game_1.Game.create();
});
})();

/******/ })()
;